<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,IE=9,chrome=1"><meta name="generator" content="MATLAB R2019b"><title>Small Test Exact Solution Looped Minimizer</title><style type="text/css">.rtcContent { padding: 30px; } .S0 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 28.8px; min-height: 0px; white-space: pre-wrap; color: rgb(213, 80, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 24px; font-weight: 400; text-align: left;  }
.S1 { margin: 2px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }
.S2 { margin: 3px 10px 5px 4px; padding: 0px; line-height: 20px; min-height: 0px; white-space: pre-wrap; color: rgb(60, 60, 60); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 20px; font-weight: 700; text-align: left;  }
.CodeBlock { background-color: #F7F7F7; margin: 10px 0 10px 0;}
.S3 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 1px solid rgb(233, 233, 233); border-bottom: 0px none rgb(0, 0, 0); border-radius: 4px 4px 0px 0px; padding: 6px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S4 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px; padding: 0px 45px 4px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S5 { color: rgb(64, 64, 64); padding: 10px 0px 6px 17px; background: rgb(255, 255, 255) none repeat scroll 0% 0% / auto padding-box border-box; font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px; overflow-x: hidden; line-height: 16.996px;  }
.embeddedOutputsErrorElement {min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsErrorElement.inlineElement {}
.embeddedOutputsErrorElement.rightPaneElement {}
.embeddedOutputsWarningElement{min-height: 18px; max-height: 250px; overflow: auto;}
.embeddedOutputsWarningElement.inlineElement {}
.embeddedOutputsWarningElement.rightPaneElement {}
.diagnosticMessage-wrapper {font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 12px;}
.diagnosticMessage-wrapper.diagnosticMessage-warningType {color: rgb(255,100,0);}
.diagnosticMessage-wrapper.diagnosticMessage-warningType a {color: rgb(255,100,0); text-decoration: underline;}
.diagnosticMessage-wrapper.diagnosticMessage-errorType {color: rgb(230,0,0);}
.diagnosticMessage-wrapper.diagnosticMessage-errorType a {color: rgb(230,0,0); text-decoration: underline;}
.diagnosticMessage-wrapper .diagnosticMessage-messagePart,.diagnosticMessage-wrapper .diagnosticMessage-causePart {white-space: pre-wrap;}
.diagnosticMessage-wrapper .diagnosticMessage-stackPart {white-space: pre;}
.embeddedOutputsTextElement,.embeddedOutputsVariableStringElement {white-space: pre; word-wrap: initial; min-height: 18px; max-height: 250px; overflow: auto;}
.textElement,.rtcDataTipElement .textElement {padding-top: 3px;}
.embeddedOutputsTextElement.inlineElement,.embeddedOutputsVariableStringElement.inlineElement {}
.inlineElement .textElement {}
.embeddedOutputsTextElement.rightPaneElement,.embeddedOutputsVariableStringElement.rightPaneElement {min-height: 16px;}
.rightPaneElement .textElement {padding-top: 2px; padding-left: 9px;}
.S6 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 0px none rgb(0, 0, 0); border-radius: 0px; padding: 0px 45px 0px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S7 { border-left: 1px solid rgb(233, 233, 233); border-right: 1px solid rgb(233, 233, 233); border-top: 0px none rgb(0, 0, 0); border-bottom: 1px solid rgb(233, 233, 233); border-radius: 0px 0px 4px 4px; padding: 0px 45px 4px 13px; line-height: 16.996px; min-height: 18px; white-space: nowrap; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, "Courier New", monospace; font-size: 14px;  }
.S8 { margin: 10px 10px 9px 4px; padding: 0px; line-height: 21px; min-height: 0px; white-space: pre-wrap; color: rgb(0, 0, 0); font-family: Helvetica, Arial, sans-serif; font-style: normal; font-size: 14px; font-weight: 400; text-align: left;  }</style></head><body><div class = rtcContent><h1  class = 'S0'><span>Small Test Exact Solution Looped Minimizer</span></h1><div  class = 'S1'><span>This is the example vignette for function: </span><a href = "https://github.com/FanWangEcon/PrjOptiSNW/blob/master/PrjOptiSNW/svalpol/snw_vfi_main.m"><span style=' font-weight: bold;'>snw_vfi_main</span></a><span> from the </span><a href = "https://fanwangecon.github.io/PrjOptiSNW/"><span style=' font-weight: bold;'>PrjOptiSNW Package</span></a><span style=' font-weight: bold;'>. </span><span>This function solves for policy function fully iteratively using matlab minimizer. Small Solution Analysis.</span></div><h2  class = 'S2'><span>Test SNW_VFI_MAIN Defaults Small</span></h2><div  class = 'S1'><span>Call the function with defaults parameters.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_param = snw_mp_param(</span><span style="color: rgb(160, 32, 240);">'default_small'</span><span>);</span></span></div></div><div class="inlineWrapper outputs"><div  class = 'S4'><span style="white-space: pre;"><span>[V_VFI,ap_VFI,cons_VFI,mp_valpol_more] = snw_vfi_main(mp_param);</span></span></div><div  class = 'S5'><div class="inlineElement eoOutputWrapper embeddedOutputsTextElement" uid="2FC34E12" data-testid="output_0" data-width="428" data-height="18" data-hashorizontaloverflow="false" style="width: 458px; max-height: 261px;"><div class="textElement">SNW_VFI_MAIN: Finished Age Group:18 of 18</div></div></div></div></div><h2  class = 'S2'><span>Small Param Results Define Frames</span></h2><div  class = 'S1'><span>Define the matrix dimensions names and dimension vector values. Policy and Value Functions share the same ND dimensional structure.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Grids:</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>age_grid = [19, 22:5:97, 100];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>agrid = mp_param(</span><span style="color: rgb(160, 32, 240);">'agrid'</span><span>)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>eta_H_grid = mp_param(</span><span style="color: rgb(160, 32, 240);">'eta_H_grid'</span><span>)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>eta_S_grid = mp_param(</span><span style="color: rgb(160, 32, 240);">'eta_S_grid'</span><span>)';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>ar_st_eta_HS_grid = string(cellstr([num2str(eta_H_grid', </span><span style="color: rgb(160, 32, 240);">'hz=%3.2f;'</span><span>), num2str(eta_S_grid', </span><span style="color: rgb(160, 32, 240);">'wz=%3.2f'</span><span>)]));</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>edu_grid = [0,1];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>marry_grid = [0,1];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>kids_grid = (1:1:mp_param(</span><span style="color: rgb(160, 32, 240);">'n_kidsgrid'</span><span>))';</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>cl_mp_datasetdesc = {};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>cl_mp_datasetdesc{1} = containers.Map({</span><span style="color: rgb(160, 32, 240);">'name'</span><span>, </span><span style="color: rgb(160, 32, 240);">'labval'</span><span>}, {</span><span style="color: rgb(160, 32, 240);">'age'</span><span>, age_grid});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>cl_mp_datasetdesc{2} = containers.Map({</span><span style="color: rgb(160, 32, 240);">'name'</span><span>, </span><span style="color: rgb(160, 32, 240);">'labval'</span><span>}, {</span><span style="color: rgb(160, 32, 240);">'savings'</span><span>, agrid});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>cl_mp_datasetdesc{3} = containers.Map({</span><span style="color: rgb(160, 32, 240);">'name'</span><span>, </span><span style="color: rgb(160, 32, 240);">'labval'</span><span>}, {</span><span style="color: rgb(160, 32, 240);">'eta'</span><span>, 1:length(eta_H_grid)});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>cl_mp_datasetdesc{4} = containers.Map({</span><span style="color: rgb(160, 32, 240);">'name'</span><span>, </span><span style="color: rgb(160, 32, 240);">'labval'</span><span>}, {</span><span style="color: rgb(160, 32, 240);">'edu'</span><span>, edu_grid});</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>cl_mp_datasetdesc{5} = containers.Map({</span><span style="color: rgb(160, 32, 240);">'name'</span><span>, </span><span style="color: rgb(160, 32, 240);">'labval'</span><span>}, {</span><span style="color: rgb(160, 32, 240);">'marry'</span><span>, marry_grid});</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>cl_mp_datasetdesc{6} = containers.Map({</span><span style="color: rgb(160, 32, 240);">'name'</span><span>, </span><span style="color: rgb(160, 32, 240);">'labval'</span><span>}, {</span><span style="color: rgb(160, 32, 240);">'kids'</span><span>, kids_grid});</span></span></div></div></div><h2  class = 'S2'><span>Analyze Savings and Shocks</span></h2><div  class = 'S1'><span>First, analyze Savings Levels and Shocks, Aggregate Over All Others, and do various other calculations.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Generate some Data</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph = containers.Map(</span><span style="color: rgb(160, 32, 240);">'KeyType'</span><span>, </span><span style="color: rgb(160, 32, 240);">'char'</span><span>, </span><span style="color: rgb(160, 32, 240);">'ValueType'</span><span>, </span><span style="color: rgb(160, 32, 240);">'any'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_xtitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'Savings States, a'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'st_legend_loc'</span><span>) = </span><span style="color: rgb(160, 32, 240);">'best'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'bl_graph_logy'</span><span>) = true; </span><span style="color: rgb(60, 118, 61);">% do not log</span></span></div></div></div><div  class = 'S8'><span>MEAN(VAL(A,Z)), MEAN(AP(A,Z)), MEAN(C(A,Z))</span></div><div  class = 'S1'><span>Tabulate value and policies along savings and shocks:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Set</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>ar_permute = [1,4,5,6,3,2];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Value Function</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>tb_az_v = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(VAL(A,Z))"</span><span>, V_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 4, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Aprime Choice</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>tb_az_ap = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(AP(A,Z))"</span><span>, ap_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 4, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div></div><div  class = 'S8'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Consumption Choices</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>tb_az_c = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(C(A,Z))"</span><span>, cons_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 4, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Values:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(value(a,z)), a=x, z=color'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(value(a,z))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_v{1:end, 3:end})', ar_st_eta_HS_grid, agrid, mp_support_graph);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Savings Choices:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(APRIME(a,z)), a=x, z=color'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(APRIME(a,z))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_ap{1:end, 3:end})', ar_st_eta_HS_grid, agrid, mp_support_graph);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Consumption:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(C(a,z)), a=x, z=color'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(C(a,z))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_c{1:end, 3:end})', ar_st_eta_HS_grid, agrid, mp_support_graph);</span></span></div></div></div><h2  class = 'S2'><span>Analyze Kids and Marriage and Age</span></h2><div  class = 'S1'><span>Aggregating over education, savings, and shocks, what are the differential effects of Marriage and Age.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Generate some Data</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph = containers.Map(</span><span style="color: rgb(160, 32, 240);">'KeyType'</span><span>, </span><span style="color: rgb(160, 32, 240);">'char'</span><span>, </span><span style="color: rgb(160, 32, 240);">'ValueType'</span><span>, </span><span style="color: rgb(160, 32, 240);">'any'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>ar_row_grid = [</span><span style="color: rgb(160, 32, 240);">"k0M0"</span><span>, </span><span style="color: rgb(160, 32, 240);">"K1M0"</span><span>, </span><span style="color: rgb(160, 32, 240);">"K2M0"</span><span>, </span><span style="color: rgb(160, 32, 240);">"k0M1"</span><span>, </span><span style="color: rgb(160, 32, 240);">"K1M1"</span><span>, </span><span style="color: rgb(160, 32, 240);">"K2M1"</span><span>];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_xtitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'Age'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'st_legend_loc'</span><span>) = </span><span style="color: rgb(160, 32, 240);">'best'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'bl_graph_logy'</span><span>) = true; </span><span style="color: rgb(60, 118, 61);">% do not log</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'st_rounding'</span><span>) = </span><span style="color: rgb(160, 32, 240);">'6.2f'</span><span>; </span><span style="color: rgb(60, 118, 61);">% format shock legend</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_scatter_shapes'</span><span>) = { </span><span style="color: rgb(160, 32, 240);">'o'</span><span>, </span><span style="color: rgb(160, 32, 240);">'d' </span><span>,</span><span style="color: rgb(160, 32, 240);">'s'</span><span>, </span><span style="color: rgb(160, 32, 240);">'o'</span><span>, </span><span style="color: rgb(160, 32, 240);">'d'</span><span>, </span><span style="color: rgb(160, 32, 240);">'s'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_colors'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'red'</span><span>, </span><span style="color: rgb(160, 32, 240);">'red'</span><span>, </span><span style="color: rgb(160, 32, 240);">'red'</span><span>, </span><span style="color: rgb(160, 32, 240);">'blue'</span><span>, </span><span style="color: rgb(160, 32, 240);">'blue'</span><span>, </span><span style="color: rgb(160, 32, 240);">'blue'</span><span>};</span></span></div></div></div><div  class = 'S8'><span>MEAN(VAL(KM,J)), MEAN(AP(KM,J)), MEAN(C(KM,J))</span></div><div  class = 'S1'><span>Tabulate value and policies:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Set</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>ar_permute = [2,3,4,1,6,5];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Value Function</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>tb_az_v = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(VAL(KM,J))"</span><span>, V_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 3, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Aprime Choice</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>tb_az_ap = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(AP(KM,J))"</span><span>, ap_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 3, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div></div><div  class = 'S8'><span></span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Consumption Choices</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>tb_az_c = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(C(KM,J))"</span><span>, cons_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 3, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Values:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(value(KM,J)), a=age, z=kids+marry'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(value(KM,J))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_v{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Savings Choices:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(APRIME(KM,J)), a=x, z=color'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(APRIME(KM,J))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_ap{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Consumption:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(C(KM,J)), a=x, z=color'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(C(KM,J))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_c{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);</span></span></div></div></div><h2  class = 'S2'><span>Analyze Education and Marriage and Age</span></h2><div  class = 'S1'><span>Aggregating over education, savings, and shocks, what are the differential effects of Marriage and Age.</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Generate some Data</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph = containers.Map(</span><span style="color: rgb(160, 32, 240);">'KeyType'</span><span>, </span><span style="color: rgb(160, 32, 240);">'char'</span><span>, </span><span style="color: rgb(160, 32, 240);">'ValueType'</span><span>, </span><span style="color: rgb(160, 32, 240);">'any'</span><span>);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>ar_row_grid = [</span><span style="color: rgb(160, 32, 240);">"E0M0"</span><span>, </span><span style="color: rgb(160, 32, 240);">"E1M0"</span><span>, </span><span style="color: rgb(160, 32, 240);">"E0M1"</span><span>, </span><span style="color: rgb(160, 32, 240);">"E1M1"</span><span>];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_xtitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'Age'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'st_legend_loc'</span><span>) = </span><span style="color: rgb(160, 32, 240);">'best'</span><span>;</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'bl_graph_logy'</span><span>) = true; </span><span style="color: rgb(60, 118, 61);">% do not log</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'st_rounding'</span><span>) = </span><span style="color: rgb(160, 32, 240);">'6.2f'</span><span>; </span><span style="color: rgb(60, 118, 61);">% format shock legend</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_scatter_shapes'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'*'</span><span>, </span><span style="color: rgb(160, 32, 240);">'p'</span><span>, </span><span style="color: rgb(160, 32, 240);">'*'</span><span>,</span><span style="color: rgb(160, 32, 240);">'p' </span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_colors'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'red'</span><span>, </span><span style="color: rgb(160, 32, 240);">'red'</span><span>, </span><span style="color: rgb(160, 32, 240);">'blue'</span><span>, </span><span style="color: rgb(160, 32, 240);">'blue'</span><span>};</span></span></div></div></div><div  class = 'S8'><span>MEAN(VAL(EKM,J)), MEAN(AP(EKM,J)), MEAN(C(EKM,J))</span></div><div  class = 'S1'><span>Tabulate value and policies:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Set</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>ar_permute = [2,3,6,1,4,5];</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Value Function</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>tb_az_v = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(VAL(EKM,J))"</span><span>, V_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 3, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Aprime Choice</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>tb_az_ap = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(AP(EKM,J))"</span><span>, ap_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 3, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span style="color: rgb(60, 118, 61);">% Consumption Choices</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>tb_az_c = ff_summ_nd_array(</span><span style="color: rgb(160, 32, 240);">"MEAN(C(EKM,J))"</span><span>, cons_VFI, true, [</span><span style="color: rgb(160, 32, 240);">"mean"</span><span>], 3, 1, cl_mp_datasetdesc, ar_permute);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Values:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(value(EM,J)), a=age, z=kids+marry'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(value(EM,J))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_v{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Savings Choices:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(APRIME(EK,J)), a=x, z=color'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(APRIME(EK,J))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_ap{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);</span></span></div></div></div><div  class = 'S1'><span>Graph Mean Consumption:</span></div><div class="CodeBlock"><div class="inlineWrapper"><div  class = 'S3'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_graph_title'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(C(EK,J)), a=x, z=color'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S6'><span style="white-space: pre;"><span>mp_support_graph(</span><span style="color: rgb(160, 32, 240);">'cl_st_ytitle'</span><span>) = {</span><span style="color: rgb(160, 32, 240);">'MEAN(C(EK,J))'</span><span>};</span></span></div></div><div class="inlineWrapper"><div  class = 'S7'><span style="white-space: pre;"><span>ff_graph_grid((tb_az_c{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);</span></span></div></div></div></div>
<br>
<!-- 
##### SOURCE BEGIN #####
%% Small Test Exact Solution Looped Minimizer
% This is the example vignette for function: <https://github.com/FanWangEcon/PrjOptiSNW/blob/master/PrjOptiSNW/svalpol/snw_vfi_main.m 
% *snw_vfi_main*> from the <https://fanwangecon.github.io/PrjOptiSNW/ *PrjOptiSNW 
% Package*>*.* This function solves for policy function fully iteratively using 
% matlab minimizer. Small Solution Analysis.
%% Test SNW_VFI_MAIN Defaults Small
% Call the function with defaults parameters.

mp_param = snw_mp_param('default_small');
[V_VFI,ap_VFI,cons_VFI,mp_valpol_more] = snw_vfi_main(mp_param);
%% Small Param Results Define Frames
% Define the matrix dimensions names and dimension vector values. Policy and 
% Value Functions share the same ND dimensional structure.

% Grids:
age_grid = [19, 22:5:97, 100];
agrid = mp_param('agrid')';
eta_H_grid = mp_param('eta_H_grid')';
eta_S_grid = mp_param('eta_S_grid')';
ar_st_eta_HS_grid = string(cellstr([num2str(eta_H_grid', 'hz=%3.2f;'), num2str(eta_S_grid', 'wz=%3.2f')]));
edu_grid = [0,1];
marry_grid = [0,1];
kids_grid = (1:1:mp_param('n_kidsgrid'))';
% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
cl_mp_datasetdesc = {};
cl_mp_datasetdesc{1} = containers.Map({'name', 'labval'}, {'age', age_grid});
cl_mp_datasetdesc{2} = containers.Map({'name', 'labval'}, {'savings', agrid});
cl_mp_datasetdesc{3} = containers.Map({'name', 'labval'}, {'eta', 1:length(eta_H_grid)});
cl_mp_datasetdesc{4} = containers.Map({'name', 'labval'}, {'edu', edu_grid});
cl_mp_datasetdesc{5} = containers.Map({'name', 'labval'}, {'marry', marry_grid});
cl_mp_datasetdesc{6} = containers.Map({'name', 'labval'}, {'kids', kids_grid});
%% Analyze Savings and Shocks
% First, analyze Savings Levels and Shocks, Aggregate Over All Others, and do 
% various other calculations.

% Generate some Data
mp_support_graph = containers.Map('KeyType', 'char', 'ValueType', 'any');
mp_support_graph('cl_st_xtitle') = {'Savings States, a'};
mp_support_graph('st_legend_loc') = 'best';
mp_support_graph('bl_graph_logy') = true; % do not log
%% 
% MEAN(VAL(A,Z)), MEAN(AP(A,Z)), MEAN(C(A,Z))
% 
% Tabulate value and policies along savings and shocks:

% Set
% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
ar_permute = [1,4,5,6,3,2];
% Value Function
tb_az_v = ff_summ_nd_array("MEAN(VAL(A,Z))", V_VFI, true, ["mean"], 4, 1, cl_mp_datasetdesc, ar_permute);
% Aprime Choice
tb_az_ap = ff_summ_nd_array("MEAN(AP(A,Z))", ap_VFI, true, ["mean"], 4, 1, cl_mp_datasetdesc, ar_permute);
%% 
% 

% Consumption Choices
tb_az_c = ff_summ_nd_array("MEAN(C(A,Z))", cons_VFI, true, ["mean"], 4, 1, cl_mp_datasetdesc, ar_permute);
%% 
% Graph Mean Values:

mp_support_graph('cl_st_graph_title') = {'MEAN(value(a,z)), a=x, z=color'};
mp_support_graph('cl_st_ytitle') = {'MEAN(value(a,z))'};
ff_graph_grid((tb_az_v{1:end, 3:end})', ar_st_eta_HS_grid, agrid, mp_support_graph);
%% 
% Graph Mean Savings Choices:

mp_support_graph('cl_st_graph_title') = {'MEAN(APRIME(a,z)), a=x, z=color'};
mp_support_graph('cl_st_ytitle') = {'MEAN(APRIME(a,z))'};
ff_graph_grid((tb_az_ap{1:end, 3:end})', ar_st_eta_HS_grid, agrid, mp_support_graph);
%% 
% Graph Mean Consumption:

mp_support_graph('cl_st_graph_title') = {'MEAN(C(a,z)), a=x, z=color'};
mp_support_graph('cl_st_ytitle') = {'MEAN(C(a,z))'};
ff_graph_grid((tb_az_c{1:end, 3:end})', ar_st_eta_HS_grid, agrid, mp_support_graph);
%% Analyze Kids and Marriage and Age
% Aggregating over education, savings, and shocks, what are the differential 
% effects of Marriage and Age.

% Generate some Data
mp_support_graph = containers.Map('KeyType', 'char', 'ValueType', 'any');
ar_row_grid = ["k0M0", "K1M0", "K2M0", "k0M1", "K1M1", "K2M1"];
mp_support_graph('cl_st_xtitle') = {'Age'};
mp_support_graph('st_legend_loc') = 'best';
mp_support_graph('bl_graph_logy') = true; % do not log
mp_support_graph('st_rounding') = '6.2f'; % format shock legend
mp_support_graph('cl_scatter_shapes') = { 'o', 'd' ,'s', 'o', 'd', 's'};
mp_support_graph('cl_colors') = {'red', 'red', 'red', 'blue', 'blue', 'blue'};
%% 
% MEAN(VAL(KM,J)), MEAN(AP(KM,J)), MEAN(C(KM,J))
% 
% Tabulate value and policies:

% Set
% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
ar_permute = [2,3,4,1,6,5];
% Value Function
tb_az_v = ff_summ_nd_array("MEAN(VAL(KM,J))", V_VFI, true, ["mean"], 3, 1, cl_mp_datasetdesc, ar_permute);
% Aprime Choice
tb_az_ap = ff_summ_nd_array("MEAN(AP(KM,J))", ap_VFI, true, ["mean"], 3, 1, cl_mp_datasetdesc, ar_permute);
%% 
% 

% Consumption Choices
tb_az_c = ff_summ_nd_array("MEAN(C(KM,J))", cons_VFI, true, ["mean"], 3, 1, cl_mp_datasetdesc, ar_permute);
%% 
% Graph Mean Values:

mp_support_graph('cl_st_graph_title') = {'MEAN(value(KM,J)), a=age, z=kids+marry'};
mp_support_graph('cl_st_ytitle') = {'MEAN(value(KM,J))'};
ff_graph_grid((tb_az_v{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);
%% 
% Graph Mean Savings Choices:

mp_support_graph('cl_st_graph_title') = {'MEAN(APRIME(KM,J)), a=x, z=color'};
mp_support_graph('cl_st_ytitle') = {'MEAN(APRIME(KM,J))'};
ff_graph_grid((tb_az_ap{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);
%% 
% Graph Mean Consumption:

mp_support_graph('cl_st_graph_title') = {'MEAN(C(KM,J)), a=x, z=color'};
mp_support_graph('cl_st_ytitle') = {'MEAN(C(KM,J))'};
ff_graph_grid((tb_az_c{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);
%% Analyze Education and Marriage and Age
% Aggregating over education, savings, and shocks, what are the differential 
% effects of Marriage and Age.

% Generate some Data
mp_support_graph = containers.Map('KeyType', 'char', 'ValueType', 'any');
ar_row_grid = ["E0M0", "E1M0", "E0M1", "E1M1"];
mp_support_graph('cl_st_xtitle') = {'Age'};
mp_support_graph('st_legend_loc') = 'best';
mp_support_graph('bl_graph_logy') = true; % do not log
mp_support_graph('st_rounding') = '6.2f'; % format shock legend
mp_support_graph('cl_scatter_shapes') = {'*', 'p', '*','p' };
mp_support_graph('cl_colors') = {'red', 'red', 'blue', 'blue'};
%% 
% MEAN(VAL(EKM,J)), MEAN(AP(EKM,J)), MEAN(C(EKM,J))
% 
% Tabulate value and policies:

% Set
% NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
ar_permute = [2,3,6,1,4,5];
% Value Function
tb_az_v = ff_summ_nd_array("MEAN(VAL(EKM,J))", V_VFI, true, ["mean"], 3, 1, cl_mp_datasetdesc, ar_permute);
% Aprime Choice
tb_az_ap = ff_summ_nd_array("MEAN(AP(EKM,J))", ap_VFI, true, ["mean"], 3, 1, cl_mp_datasetdesc, ar_permute);
% Consumption Choices
tb_az_c = ff_summ_nd_array("MEAN(C(EKM,J))", cons_VFI, true, ["mean"], 3, 1, cl_mp_datasetdesc, ar_permute);
%% 
% Graph Mean Values:

mp_support_graph('cl_st_graph_title') = {'MEAN(value(EM,J)), a=age, z=kids+marry'};
mp_support_graph('cl_st_ytitle') = {'MEAN(value(EM,J))'};
ff_graph_grid((tb_az_v{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);
%% 
% Graph Mean Savings Choices:

mp_support_graph('cl_st_graph_title') = {'MEAN(APRIME(EK,J)), a=x, z=color'};
mp_support_graph('cl_st_ytitle') = {'MEAN(APRIME(EK,J))'};
ff_graph_grid((tb_az_ap{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);
%% 
% Graph Mean Consumption:

mp_support_graph('cl_st_graph_title') = {'MEAN(C(EK,J)), a=x, z=color'};
mp_support_graph('cl_st_ytitle') = {'MEAN(C(EK,J))'};
ff_graph_grid((tb_az_c{1:end, 4:end}), ar_row_grid, age_grid, mp_support_graph);
##### SOURCE END #####
--></body></html>