
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>SNW_VFI_MAIN Solves Policy/Value Function SNW (Loop)</title><meta name="generator" content="MATLAB 9.7"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2020-06-24"><meta name="DC.source" content="snw_vfi_main.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>SNW_VFI_MAIN Solves Policy/Value Function SNW (Loop)</h1><!--introduction--><pre>  Given parameters, iterate over life cycle, given age, marital status,
  education level and child count, as well as persistent productivity
  shock process, solve for optimal dynamic savings choices given
  expectation of kid count transition and productivity shock transition.</pre><pre>  Pref, Technology, and prices SCALARS:</pre><pre>  * BETA discount
  * THETA total factor productivity normalizer
  * R interest rate</pre><pre>  Vectorized State Space ARRAYS:</pre><pre>  * AGRID asset grid
  * ETA_GRID productivity shock grid</pre><pre>  Transition Matrixes ARRAYS:</pre><pre>  * PI_ETA shock productivity transition
  * PI_KIDS shock kids count transition
  * PSI shock survival probability</pre><pre>  Permanent Education Type Heterogeneity ARRAYS:</pre><pre>  * EPSILON perfect-foresight education type transition
  * SS Social Security</pre><pre>  [V_VFI,AP_VFI,CONS_VFI,EXITFLAG_VFI] = SNW_VFI_MAIN(MP_PARAMS) invoke
  model with externally set parameter map MP_PARAMS.</pre><pre>  [V_VFI,AP_VFI,CONS_VFI,EXITFLAG_VFI] = SNW_VFI_MAIN(MP_PARAMS,
  MP_CONTROLS) invoke model with externally set parameter map MP_PARAMS
  as well as control mpa MP_CONTROLS.</pre><pre>  See also SNWX_VFI_MAIN, SNW_MP_CONTROL, SNW_MP_PARAM</pre><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#3">Default and Parse</a></li><li><a href="#4">Reset All globals</a></li><li><a href="#5">Parse Model Parameters</a></li><li><a href="#6">Parse Model Controls</a></li><li><a href="#7">Timing and Profiling Start</a></li><li><a href="#8">Solve optimization problem</a></li><li><a href="#9">Timing and Profiling End</a></li></ul></div><pre class="codeinput"><span class="keyword">function</span> [V_VFI,ap_VFI,cons_VFI,exitflag_VFI]=snw_vfi_main(varargin)
</pre><h2 id="3">Default and Parse</h2><pre class="codeinput"><span class="keyword">if</span> (~isempty(varargin))

    <span class="keyword">if</span> (length(varargin)==1)
        [mp_params] = varargin{:};
        mp_controls = snw_mp_control(<span class="string">'default_base'</span>);
    <span class="keyword">elseif</span> (length(varargin)==2)
        [mp_params, mp_controls] = varargin{:};
    <span class="keyword">end</span>

<span class="keyword">else</span>

    mp_params = snw_mp_param(<span class="string">'default_tiny'</span>);
    mp_controls = snw_mp_control(<span class="string">'default_test'</span>);

<span class="keyword">end</span>
</pre><h2 id="4">Reset All globals</h2><p>globals = who('global'); clear(globals{:}); Parameters used in this code directly</p><pre class="codeinput"><span class="keyword">global</span> beta theta r agrid epsilon eta_grid SS pi_eta pi_kids psi n_jgrid n_agrid n_etagrid n_educgrid n_marriedgrid n_kidsgrid
<span class="comment">% Used in functions that are called by this code</span>
<span class="keyword">global</span> gamma g_n g_cons a2 cons_allocation_rule
</pre><h2 id="5">Parse Model Parameters</h2><pre class="codeinput">params_group = values(mp_params, {<span class="string">'gamma'</span>, <span class="string">'beta'</span>, <span class="string">'theta'</span>, <span class="string">'cons_allocation_rule'</span>, <span class="keyword">...</span>
    <span class="string">'r'</span>, <span class="string">'g_n'</span>, <span class="string">'g_cons'</span>, <span class="string">'a2'</span>});
[gamma, beta, theta, cons_allocation_rule, <span class="keyword">...</span>
    r, g_n, g_cons, a2] = params_group{:};

params_group = values(mp_params, {<span class="string">'agrid'</span>, <span class="string">'eta_grid'</span>});
[agrid, eta_grid] = params_group{:};

params_group = values(mp_params, {<span class="string">'pi_eta'</span>, <span class="string">'pi_kids'</span>, <span class="string">'psi'</span>});
[pi_eta, pi_kids, psi] = params_group{:};

params_group = values(mp_params, {<span class="string">'epsilon'</span>, <span class="string">'SS'</span>});
[epsilon, SS] = params_group{:};

params_group = values(mp_params, <span class="keyword">...</span>
    {<span class="string">'n_jgrid'</span>, <span class="string">'n_agrid'</span>, <span class="string">'n_etagrid'</span>, <span class="string">'n_educgrid'</span>, <span class="string">'n_marriedgrid'</span>, <span class="string">'n_kidsgrid'</span>});
[n_jgrid, n_agrid, n_etagrid, n_educgrid, n_marriedgrid, n_kidsgrid] = params_group{:};
</pre><h2 id="6">Parse Model Controls</h2><p>Minimizer Controls</p><pre class="codeinput">params_group = values(mp_controls, <span class="keyword">...</span>
    {<span class="string">'A_aux'</span>, <span class="string">'B_aux'</span>, <span class="keyword">...</span>
     <span class="string">'Aeq'</span>, <span class="string">'Beq'</span>,<span class="keyword">...</span>
     <span class="string">'nonlcon'</span>, <span class="string">'options'</span>, <span class="string">'options2'</span>});
[A_aux, B_aux, <span class="keyword">...</span>
    Aeq, Beq, <span class="keyword">...</span>
    nonlcon, options, options2] = params_group{:};

<span class="comment">% Profiling Controls</span>
params_group = values(mp_controls, {<span class="string">'bl_timer'</span>});
[bl_timer] = params_group{:};

<span class="comment">% Display Controls</span>
params_group = values(mp_controls, {<span class="string">'bl_print_vfi'</span>, <span class="string">'bl_print_vfi_verbose'</span>});
[bl_print_vfi, bl_print_vfi_verbose] = params_group{:};
</pre><h2 id="7">Timing and Profiling Start</h2><pre class="codeinput"><span class="keyword">if</span> (bl_timer)
    tic
<span class="keyword">end</span>
</pre><h2 id="8">Solve optimization problem</h2><pre class="codeinput">V_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
ap_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
cons_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);

exitflag_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);

<span class="comment">% Solve for value function and policy functions by means of backwards induction</span>
<span class="keyword">for</span> j=n_jgrid:(-1):1 <span class="comment">% Age</span>
    <span class="keyword">for</span> a=1:n_agrid <span class="comment">% Assets</span>
        <span class="keyword">for</span> eta=1:n_etagrid <span class="comment">% Productivity</span>
            <span class="keyword">for</span> educ=1:n_educgrid <span class="comment">% Educational level</span>
                <span class="keyword">for</span> married=1:n_marriedgrid <span class="comment">% Marital status</span>
                    <span class="keyword">for</span> kids=1:n_kidsgrid <span class="comment">% Number of kids</span>

                        <span class="keyword">if</span> j==n_jgrid

                            ap_VFI(j,a,eta,educ,married,kids)=0;
                            cons_VFI(j,a,eta,educ,married,kids) = consumption(j,a,eta,educ,married,kids,ap_VFI(j,a,eta,educ,married,kids));

                            <span class="keyword">if</span> cons_VFI(j,a,eta,educ,married,kids)&lt;=0
                                disp([j,a,eta,educ,married,kids,cons_VFI(j,a,eta,educ,married,kids)])
                                error(<span class="string">'Non-positive consumption'</span>)
                            <span class="keyword">end</span>

                            V_VFI(j,a,eta,educ,married,kids)=utility(cons_VFI(j,a,eta,educ,married,kids),married,kids);

                        <span class="keyword">else</span>

                            <span class="comment">% Solve for next period's assets</span>
                            x0=agrid(a); <span class="comment">% Initial guess for ap</span>

                            amin=0;
                            [inc,earn]=individual_income(j,a,eta,educ);
                            spouse_inc=spousal_income(j,educ,kids,earn,SS(j,educ));

                            amax = min(agrid(end), <span class="keyword">...</span>
                                (1+r)*agrid(a) <span class="keyword">...</span>
                                + epsilon(j,educ)*theta*exp(eta_grid(eta)) <span class="keyword">...</span>
                                + SS(j,educ) <span class="keyword">...</span>
                                + (married-1)*spouse_inc <span class="keyword">...</span>
                                - max(0,Tax(inc,(married-1)*spouse_inc)));

                            [ap_aux,~,exitflag_VFI(j,a,eta,educ,married,kids)]=<span class="keyword">...</span>
                                fmincon(@(x)value_func_aux(x,j,a,eta,educ,married,kids,V_VFI), <span class="keyword">...</span>
                                x0,A_aux,B_aux,Aeq,Beq,amin,amax,nonlcon,options);

                            ind_aux=find(agrid&lt;=ap_aux,1,<span class="string">'last'</span>);

                            <span class="comment">% Linear interpolation</span>
                            <span class="keyword">if</span> ap_aux==0
                                inds(1)=1;
                                inds(2)=1;
                                vals(1)=1;
                                vals(2)=0;

                            <span class="keyword">elseif</span> ap_aux==agrid(n_agrid)
                                inds(1)=n_agrid;
                                inds(2)=n_agrid;
                                vals(1)=1;
                                vals(2)=0;

                            <span class="keyword">else</span>
                                inds(1)=ind_aux;
                                inds(2)=ind_aux+1;
                                vals(1)=1-((ap_aux-agrid(inds(1)))/(agrid(inds(2))-agrid(inds(1))));
                                vals(2)=1-vals(1);

                            <span class="keyword">end</span>

                            cont=0;
                            <span class="keyword">for</span> etap=1:n_etagrid
                                <span class="keyword">for</span> kidsp=1:n_kidsgrid
                                    cont=cont <span class="keyword">...</span>
                                        +pi_eta(eta,etap)*pi_kids(kids,kidsp,j,married)*(<span class="keyword">...</span>
                                            vals(1)*V_VFI(j+1,inds(1),etap,educ,married,kidsp) <span class="keyword">...</span>
                                            +vals(2)*V_VFI(j+1,inds(2),etap,educ,married,kidsp));
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>

                            c_aux=consumption(j,a,eta,educ,married,kids,ap_aux);

                            ap_VFI(j,a,eta,educ,married,kids)=ap_aux;
                            cons_VFI(j,a,eta,educ,married,kids)=c_aux;

                            V_VFI(j,a,eta,educ,married,kids)=utility(c_aux,married,kids)+beta*psi(j)*cont;

                            c_aux3=consumption(j,a,eta,educ,married,kids,0);

                            cont=0;
                            <span class="keyword">for</span> etap=1:n_etagrid
                                <span class="keyword">for</span> kidsp=1:n_kidsgrid
                                    cont=cont+pi_eta(eta,etap)*pi_kids(kids,kidsp,j,married)*V_VFI(j+1,1,etap,educ,married,kidsp);
                                <span class="keyword">end</span>
                            <span class="keyword">end</span>
                            V_aux3=utility(c_aux3,married,kids)+beta*psi(j)*cont;

                            <span class="keyword">if</span> V_aux3&gt;V_VFI(j,a,eta,educ,married,kids)
                                ap_VFI(j,a,eta,educ,married,kids)=0;
                                cons_VFI(j,a,eta,educ,married,kids)=c_aux3;

                                V_VFI(j,a,eta,educ,married,kids)=V_aux3;
                            <span class="keyword">end</span>

                            <span class="keyword">if</span> cons_VFI(j,a,eta,educ,married,kids)&lt;=0
                                disp([j,a,eta,educ,married,kids,cons_VFI(j,a,eta,educ,married,kids)])
                                error(<span class="string">'Non-positive consumption'</span>)
                            <span class="keyword">end</span>

                        <span class="keyword">end</span>

                    <span class="keyword">end</span>
                <span class="keyword">end</span>
            <span class="keyword">end</span>
        <span class="keyword">end</span>
    <span class="keyword">end</span>

    <span class="keyword">if</span> (bl_print_vfi)
        disp(strcat([<span class="string">'SNW_VFI_MAIN: Finished Age Group:'</span> num2str(j) <span class="string">' of '</span> num2str(n_jgrid)]));
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeoutput">SNW_VFI_MAIN: Finished Age Group:7 of 7
SNW_VFI_MAIN: Finished Age Group:6 of 7
SNW_VFI_MAIN: Finished Age Group:5 of 7
SNW_VFI_MAIN: Finished Age Group:4 of 7
SNW_VFI_MAIN: Finished Age Group:3 of 7
SNW_VFI_MAIN: Finished Age Group:2 of 7
SNW_VFI_MAIN: Finished Age Group:1 of 7
</pre><h2 id="9">Timing and Profiling End</h2><pre class="codeinput"><span class="keyword">if</span> (bl_timer)
    toc;
    st_complete_vfi = strjoin(<span class="keyword">...</span>
        [<span class="string">"Completed SNW_VFI_MAIN"</span>, <span class="keyword">...</span>
         [<span class="string">'SNW_MP_PARAM='</span> mp_params(<span class="string">'mp_params_name'</span>)], <span class="keyword">...</span>
         [<span class="string">'SNW_MP_CONTROL='</span> mp_controls(<span class="string">'mp_params_name'</span>)] <span class="keyword">...</span>
        ], <span class="string">";"</span>);
    disp(st_complete_vfi);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Elapsed time is 74.589761 seconds.
Completed SNW_VFI_MAIN;SNW_MP_PARAM=;default_tiny;SNW_MP_CONTROL=;default_test
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><pre class="codeoutput">
ans(:,:,1,1,1,1) =

  Columns 1 through 7

  -31.9084  -21.9088   -4.8290    1.2038    3.1577    3.9172    4.2613
  -24.2374  -16.5871   -3.5581    1.1611    2.6956    3.2935    3.5645
  -16.8720  -11.6933   -2.4926    1.0134    2.1669    2.6173    2.8206
  -11.4473   -7.8566   -1.6136    0.8234    1.6276    1.9411    2.0811
   -5.9815   -4.1242   -0.7422    0.6748    1.1509    1.3363    1.4169
   -4.0409   -2.2625   -0.0175    0.6359    0.8584    0.9416    0.9779
   -3.9181   -2.1397    0.1052    0.6943    0.8659    0.9303    0.9594

  Columns 8 through 10

    4.4376    4.5370    4.5937
    3.7033    3.7821    3.8293
    2.9242    2.9832    3.0188
    2.1519    2.1923    2.2165
    1.4563    1.4790    1.4924
    0.9981    1.0088    1.0155
    0.9744    0.9828    0.9879


ans(:,:,2,1,1,1) =

  Columns 1 through 7

  -15.9588  -13.0470   -3.3848    1.4274    3.2056    3.9307    4.2660
  -12.6801  -10.1128   -2.4714    1.3291    2.7313    3.3035    3.5680
   -9.3427   -7.5040   -1.7392    1.1319    2.1922    2.6244    2.8230
   -7.5882   -5.7024   -1.2237    0.8842    1.6405    1.9447    2.0824
   -5.9815   -4.1242   -0.7422    0.6748    1.1509    1.3363    1.4169
   -4.0409   -2.2625   -0.0175    0.6359    0.8584    0.9416    0.9779
   -3.9181   -2.1397    0.1052    0.6943    0.8659    0.9303    0.9594

  Columns 8 through 10

    4.4395    4.5378    4.5940
    3.7047    3.7828    3.8296
    2.9251    2.9836    3.0190
    2.1523    2.1925    2.2166
    1.4563    1.4790    1.4924
    0.9981    1.0088    1.0155
    0.9744    0.9828    0.9879


ans(:,:,3,1,1,1) =

  Columns 1 through 7

   -7.2112   -6.2585   -1.6348    1.7866    3.2917    3.9562    4.2749
   -5.9483   -5.1656   -1.1859    1.5966    2.7954    3.3226    3.5747
   -4.8892   -4.1767   -0.8665    1.3198    2.2377    2.6380    2.8278
   -4.6838   -4.0119   -0.7696    0.9813    1.6639    1.9517    2.0849
   -5.9815   -4.1242   -0.7422    0.6748    1.1509    1.3363    1.4169
   -4.0409   -2.2625   -0.0175    0.6359    0.8584    0.9416    0.9779
   -3.9181   -2.1397    0.1052    0.6943    0.8659    0.9303    0.9594

  Columns 8 through 10

    4.4431    4.5394    4.5948
    3.7074    3.7840    3.8302
    2.9270    2.9845    3.0194
    2.1533    2.1929    2.2168
    1.4563    1.4790    1.4924
    0.9981    1.0088    1.0155
    0.9744    0.9828    0.9879


ans(:,:,4,1,1,1) =

  Columns 1 through 7

   -1.5556   -1.2293    0.2923    2.2939    3.4348    4.0021    4.2917
   -1.3140   -1.0626    0.2390    1.9659    2.9011    3.3568    3.5874
   -1.1606   -0.9144    0.1146    1.5727    2.3119    2.6622    2.8368
   -1.7389   -1.3312   -0.2789    1.1122    1.7024    1.9642    2.0895
   -5.9815   -4.1242   -0.7422    0.6748    1.1509    1.3363    1.4169
   -4.0409   -2.2625   -0.0175    0.6359    0.8584    0.9416    0.9779
   -3.9181   -2.1397    0.1052    0.6943    0.8659    0.9303    0.9594

  Columns 8 through 10

    4.4500    4.5426    4.5963
    3.7126    3.7864    3.8313
    2.9307    2.9861    3.0202
    2.1552    2.1937    2.2172
    1.4563    1.4790    1.4924
    0.9981    1.0088    1.0155
    0.9744    0.9828    0.9879


ans(:,:,5,1,1,1) =

  Columns 1 through 7

    1.5871    1.6682    2.1251    2.9373    3.6475    4.0784    4.3218
    1.2824    1.3635    1.7478    2.4485    3.0571    3.4133    3.6099
    0.9042    0.9577    1.3321    1.9093    2.4180    2.7014    2.8527
   -0.1710   -0.0679    0.6519    1.2791    1.7563    1.9846    2.0978
   -5.9815   -4.1242   -0.7422    0.6748    1.1509    1.3363    1.4169
   -4.0409   -2.2625   -0.0175    0.6359    0.8584    0.9416    0.9779
   -3.9181   -2.1397    0.1052    0.6943    0.8659    0.9303    0.9594

  Columns 8 through 10

    4.4630    4.5487    4.5992
    3.7225    3.7910    3.8335
    2.9377    2.9894    3.0218
    2.1588    2.1954    2.2180
    1.4563    1.4790    1.4924
    0.9981    1.0088    1.0155
    0.9744    0.9828    0.9879


ans(:,:,1,2,1,1) =

  Columns 1 through 7

  -23.7052  -17.4021   -4.1652    1.3014    3.1773    3.9227    4.2631
  -17.7831  -13.0169   -3.0132    1.2420    2.7118    3.2980    3.5660
  -12.1066   -8.9853   -2.0519    1.0797    2.1800    2.6211    2.8218
   -8.5129   -6.2223   -1.3358    0.8659    1.6357    1.9435    2.0819
   -4.8097   -3.4274   -0.6079    0.6970    1.1547    1.3375    1.4172
   -3.2491   -1.9095    0.0347    0.6416    0.8601    0.9420    0.9780
   -3.1503   -1.8108    0.1334    0.6977    0.8665    0.9305    0.9595

  Columns 8 through 10

    4.4383    4.5373    4.5938
    3.7039    3.7824    3.8294
    2.9247    2.9834    3.0189
    2.1522    2.1924    2.2166
    1.4564    1.4791    1.4924
    0.9982    1.0089    1.0155
    0.9744    0.9828    0.9879


ans(:,:,2,2,1,1) =

  Columns 1 through 7

  -11.4290   -9.6696   -2.5764    1.5774    3.2390    3.9403    4.2692
   -8.8649   -7.4276   -1.8162    1.4514    2.7585    3.3114    3.5707
   -6.3565   -5.4398   -1.2212    1.2300    2.2139    2.6308    2.8252
   -5.3450   -4.3620   -0.9056    0.9424    1.6528    1.9484    2.0836
   -4.8097   -3.4274   -0.6079    0.6970    1.1547    1.3375    1.4172
   -3.2491   -1.9095    0.0347    0.6416    0.8601    0.9420    0.9780
   -3.1503   -1.8108    0.1334    0.6977    0.8665    0.9305    0.9595

  Columns 8 through 10

    4.4408    4.5384    4.5943
    3.7058    3.7832    3.8298
    2.9260    2.9840    3.0192
    2.1528    2.1927    2.2167
    1.4564    1.4791    1.4924
    0.9982    1.0089    1.0155
    0.9744    0.9828    0.9879


ans(:,:,3,2,1,1) =

  Columns 1 through 7

   -4.3609   -3.7619   -0.7886    1.9962    3.3463    3.9731    4.2809
   -3.4547   -2.9909   -0.5112    1.7645    2.8393    3.3363    3.5796
   -2.7703   -2.2912   -0.3400    1.4515    2.2723    2.6489    2.8317
   -3.1874   -2.6285   -0.4556    1.0566    1.6826    1.9576    2.0869
   -4.8097   -3.4274   -0.6079    0.6970    1.1547    1.3375    1.4172
   -3.2491   -1.9095    0.0347    0.6416    0.8601    0.9420    0.9780
   -3.1503   -1.8108    0.1334    0.6977    0.8665    0.9305    0.9595

  Columns 8 through 10

    4.4455    4.5405    4.5954
    3.7094    3.7849    3.8306
    2.9286    2.9852    3.0197
    2.1541    2.1932    2.2170
    1.4564    1.4791    1.4924
    0.9982    1.0089    1.0155
    0.9744    0.9828    0.9879


ans(:,:,4,2,1,1) =

  Columns 1 through 7

   -0.0298    0.1713    1.1207    2.5520    3.5158    4.0301    4.3024
    0.0048    0.1548    0.9583    2.1721    2.9653    3.3793    3.5960
   -0.0007    0.1201    0.7387    1.7328    2.3613    2.6798    2.8436
   -0.6855   -0.5484    0.1303    1.1964    1.7286    1.9735    2.0930
   -4.8097   -3.4274   -0.6079    0.6970    1.1547    1.3375    1.4172
   -3.2491   -1.9095    0.0347    0.6416    0.8601    0.9420    0.9780
   -3.1503   -1.8108    0.1334    0.6977    0.8665    0.9305    0.9595

  Columns 8 through 10

    4.4545    4.5447    4.5974
    3.7163    3.7881    3.8321
    2.9337    2.9875    3.0208
    2.1567    2.1944    2.2175
    1.4564    1.4791    1.4924
    0.9982    1.0089    1.0155
    0.9744    0.9828    0.9879


ans(:,:,5,2,1,1) =

  Columns 1 through 7

    2.3610    2.4033    2.6914    3.2208    3.7548    4.1203    4.3394
    1.9897    2.0316    2.2538    2.6942    3.1439    3.4468    3.6240
    1.5338    1.5656    1.7866    2.1223    2.4862    2.7272    2.8636
    0.5587    0.6537    1.0456    1.4101    1.7885    1.9977    2.1034
   -4.8097   -3.4274   -0.6079    0.6970    1.1547    1.3375    1.4172
   -3.2491   -1.9095    0.0347    0.6416    0.8601    0.9420    0.9780
   -3.1503   -1.8108    0.1334    0.6977    0.8665    0.9305    0.9595

  Columns 8 through 10

    4.4709    4.5525    4.6012
    3.7289    3.7941    3.8351
    2.9428    2.9919    3.0230
    2.1614    2.1966    2.2186
    1.4564    1.4791    1.4924
    0.9982    1.0089    1.0155
    0.9744    0.9828    0.9879


ans(:,:,1,1,2,1) =

  Columns 1 through 7

  -21.1963  -17.9531   -6.1733    0.1561    2.5921    3.6021    4.0721
  -15.9504  -13.5567   -4.5471    0.3500    2.2516    3.0447    3.4145
  -11.8791  -10.2104   -3.2972    0.4000    1.8339    2.4315    2.7087
   -9.3415   -7.9451   -2.3847    0.3637    1.3907    1.8120    2.0043
   -9.0906   -6.4640   -1.6812    0.3226    0.9960    1.2582    1.3722
   -6.1418   -3.6268   -0.4519    0.4722    0.7869    0.9045    0.9558
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.3163    4.4551    4.5344
    3.6067    3.7167    3.7828
    2.8520    2.9343    2.9841
    2.1023    2.1589    2.1929
    1.4279    1.4601    1.4789
    0.9844    0.9996    1.0090
    0.9637    0.9757    0.9829


ans(:,:,2,1,2,1) =

  Columns 1 through 7

  -14.3844  -12.7502   -4.8189    0.4368    2.6593    3.6220    4.0791
  -11.2645   -9.9626   -3.5840    0.5565    2.3015    3.0596    3.4198
   -8.8685   -7.8315   -2.6586    0.5432    1.8691    2.4420    2.7125
   -7.7296   -6.7788   -2.0672    0.4363    1.4087    1.8173    2.0062
   -9.0906   -6.4640   -1.6812    0.3226    0.9960    1.2582    1.3722
   -6.1418   -3.6268   -0.4519    0.4722    0.7869    0.9045    0.9558
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.3191    4.4563    4.5350
    3.6088    3.7177    3.7832
    2.8534    2.9349    2.9845
    2.1031    2.1592    2.1930
    1.4279    1.4601    1.4789
    0.9844    0.9996    1.0090
    0.9637    0.9757    0.9829


ans(:,:,3,1,2,1) =

  Columns 1 through 7

   -7.8204   -7.0110   -3.0381    0.8750    2.7751    3.6579    4.0920
   -6.2438   -5.6053   -2.3345    0.8741    2.3870    3.0864    3.4295
   -5.1741   -4.5314   -1.8372    0.7618    1.9291    2.4609    2.7194
   -5.5014   -4.5536   -1.6705    0.5475    1.4394    1.8270    2.0097
   -9.0906   -6.4640   -1.6812    0.3226    0.9960    1.2582    1.3722
   -6.1418   -3.6268   -0.4519    0.4722    0.7869    0.9045    0.9558
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.3244    4.4587    4.5361
    3.6128    3.7195    3.7841
    2.8562    2.9362    2.9851
    2.1045    2.1598    2.1933
    1.4279    1.4601    1.4789
    0.9844    0.9996    1.0090
    0.9637    0.9757    0.9829


ans(:,:,4,1,2,1) =

  Columns 1 through 7

   -2.7055   -2.3741   -0.7968    1.5046    2.9645    3.7210    4.1158
   -2.2154   -1.9598   -0.6384    1.3261    2.5256    3.1333    3.4474
   -1.9129   -1.6652   -0.6091    1.0644    2.0247    2.4938    2.7320
   -2.3341   -2.0786   -0.9977    0.6977    1.4886    1.8440    2.0162
   -9.0906   -6.4640   -1.6812    0.3226    0.9960    1.2582    1.3722
   -6.1418   -3.6268   -0.4519    0.4722    0.7869    0.9045    0.9558
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.3344    4.4633    4.5383
    3.6203    3.7229    3.7858
    2.8616    2.9386    2.9862
    2.1072    2.1610    2.1939
    1.4279    1.4601    1.4789
    0.9844    0.9996    1.0090
    0.9637    0.9757    0.9829


ans(:,:,5,1,2,1) =

  Columns 1 through 7

    0.7242    0.8133    1.3542    2.3356    3.2475    3.8251    4.1576
    0.6017    0.6860    1.1248    1.9551    2.7323    3.2099    3.4786
    0.3651    0.4244    0.8393    1.5127    2.1643    2.5464    2.7538
   -0.8207   -0.6748    0.2421    0.9294    1.5574    1.8713    2.0276
   -9.0906   -6.4640   -1.6812    0.3226    0.9960    1.2582    1.3722
   -6.1418   -3.6268   -0.4519    0.4722    0.7869    0.9045    0.9558
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.3527    4.4719    4.5424
    3.6341    3.7295    3.7889
    2.8713    2.9433    2.9885
    2.1123    2.1634    2.1950
    1.4279    1.4601    1.4789
    0.9844    0.9996    1.0090
    0.9637    0.9757    0.9829


ans(:,:,1,2,2,1) =

  Columns 1 through 7

  -15.8733  -13.8353   -5.1029    0.3677    2.6404    3.6162    4.0769
  -11.8744  -10.3848   -3.6948    0.5230    2.2915    3.0565    3.4186
   -8.8171   -7.8034   -2.6483    0.5345    1.8648    2.4408    2.7119
   -7.1864   -6.3373   -1.9738    0.4465    1.4090    1.8175    2.0061
   -7.4334   -5.4787   -1.4913    0.3542    1.0014    1.2599    1.3726
   -5.0220   -3.1276   -0.3781    0.4804    0.7892    0.9050    0.9560
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.3183    4.4559    4.5348
    3.6083    3.7174    3.7831
    2.8532    2.9348    2.9844
    2.1031    2.1592    2.1930
    1.4280    1.4601    1.4790
    0.9845    0.9996    1.0090
    0.9638    0.9757    0.9829


ans(:,:,2,2,2,1) =

  Columns 1 through 7

  -10.1538   -9.0994   -3.7003    0.6978    2.7245    3.6417    4.0860
   -7.7928   -6.9760   -2.7080    0.7664    2.3545    3.0759    3.4255
   -6.1186   -5.3817   -1.9949    0.7050    1.9100    2.4547    2.7169
   -5.8038   -5.0128   -1.6531    0.5320    1.4319    1.8246    2.0087
   -7.4334   -5.4787   -1.4913    0.3542    1.0014    1.2599    1.3726
   -5.0220   -3.1276   -0.3781    0.4804    0.7892    0.9050    0.9560
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.3219    4.4576    4.5356
    3.6111    3.7187    3.7838
    2.8553    2.9358    2.9849
    2.1041    2.1596    2.1932
    1.4280    1.4601    1.4790
    0.9845    0.9996    1.0090
    0.9638    0.9757    0.9829


ans(:,:,3,2,2,1) =

  Columns 1 through 7

   -4.8490   -4.3634   -1.8669    1.1914    2.8653    3.6871    4.1027
   -3.6929   -3.3405   -1.3826    1.1238    2.4592    3.1102    3.4383
   -2.8920   -2.5587   -1.0811    0.9513    1.9845    2.4794    2.7262
   -3.2626   -2.6789   -1.2130    0.6563    1.4697    1.8371    2.0134
   -7.4334   -5.4787   -1.4913    0.3542    1.0014    1.2599    1.3726
   -5.0220   -3.1276   -0.3781    0.4804    0.7892    0.9050    0.9560
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.3288    4.4607    4.5371
    3.6164    3.7211    3.7849
    2.8591    2.9375    2.9857
    2.1060    2.1604    2.1936
    1.4280    1.4601    1.4790
    0.9845    0.9996    1.0090
    0.9638    0.9757    0.9829


ans(:,:,4,2,2,1) =

  Columns 1 through 7

   -0.8959   -0.6918    0.2822    1.8776    3.0861    3.7645    4.1327
   -0.6714   -0.5092    0.3063    1.6269    2.6216    3.1682    3.4612
   -0.5536   -0.4516    0.2294    1.2990    2.0973    2.5207    2.7426
   -1.4340   -1.2996   -0.3588    0.8215    1.5268    1.8582    2.0218
   -7.4334   -5.4787   -1.4913    0.3542    1.0014    1.2599    1.3726
   -5.0220   -3.1276   -0.3781    0.4804    0.7892    0.9050    0.9560
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.3416    4.4666    4.5400
    3.6263    3.7257    3.7871
    2.8663    2.9408    2.9873
    2.1097    2.1621    2.1944
    1.4280    1.4601    1.4790
    0.9845    0.9996    1.0090
    0.9638    0.9757    0.9829


ans(:,:,5,2,2,1) =

  Columns 1 through 7

    1.6971    1.7463    2.0899    2.7276    3.4025    3.8865    4.1838
    1.4659    1.5106    1.7711    2.2964    2.8586    3.2591    3.4996
    1.0977    1.1381    1.4060    1.8114    2.2641    2.5841    2.7699
    0.2264    0.3101    0.6586    1.1291    1.6059    1.8901    2.0358
   -7.4334   -5.4787   -1.4913    0.3542    1.0014    1.2599    1.3726
   -5.0220   -3.1276   -0.3781    0.4804    0.7892    0.9050    0.9560
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.3647    4.4776    4.5454
    3.6438    3.7342    3.7914
    2.8789    2.9470    2.9904
    2.1162    2.1653    2.1959
    1.4280    1.4601    1.4790
    0.9845    0.9996    1.0090
    0.9638    0.9757    0.9829


ans(:,:,1,1,1,2) =

  Columns 1 through 7

  -34.6108  -23.6106   -5.3598    1.0135    3.0679    3.8668    4.2300
  -33.0885  -22.8493   -5.8357    0.3254    2.3205    3.0972    3.4500
  -22.4712  -15.6693   -4.0236    0.4477    1.9126    2.4844    2.7434
  -15.2725  -10.3806   -2.6576    0.4422    1.4572    1.8525    2.0305
   -8.2527   -5.7362   -1.4115    0.4477    1.0539    1.2876    1.3872
   -6.0933   -3.5783   -0.4035    0.4845    0.7957    0.9076    0.9586
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.4167    4.5225    4.5859
    3.6310    3.7335    3.7954
    2.8759    2.9508    2.9961
    2.1208    2.1715    2.2022
    1.4369    1.4656    1.4830
    0.9857    1.0003    1.0097
    0.9637    0.9757    0.9829


ans(:,:,2,1,1,2) =

  Columns 1 through 7

  -17.6101  -14.0439   -3.8227    1.2481    3.1176    3.8808    4.2348
  -17.7046  -14.1479   -4.3615    0.5529    2.3688    3.1107    3.4545
  -12.7008  -10.1286   -3.0033    0.6082    1.9469    2.4939    2.7466
  -10.0753   -7.5792   -2.1063    0.5281    1.4755    1.8575    2.0319
   -8.2527   -5.7362   -1.4115    0.4477    1.0539    1.2876    1.3872
   -6.0933   -3.5783   -0.4035    0.4845    0.7957    0.9076    0.9586
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.4186    4.5234    4.5863
    3.6328    3.7343    3.7958
    2.8771    2.9513    2.9964
    2.1213    2.1717    2.2023
    1.4369    1.4656    1.4830
    0.9857    1.0003    1.0097
    0.9637    0.9757    0.9829


ans(:,:,3,1,1,2) =

  Columns 1 through 7

   -7.9950   -6.9888   -1.9804    1.6231    3.2066    3.9071    4.2441
   -8.8163   -7.7895   -2.6185    0.9156    2.4556    3.1364    3.4633
   -6.8201   -5.9902   -1.8223    0.8627    2.0086    2.5123    2.7527
   -6.1622   -5.4115   -1.4640    0.6654    1.5086    1.8673    2.0349
   -8.2527   -5.7362   -1.4115    0.4477    1.0539    1.2876    1.3872
   -6.0933   -3.5783   -0.4035    0.4845    0.7957    0.9076    0.9586
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.4223    4.5251    4.5871
    3.6363    3.7359    3.7966
    2.8795    2.9524    2.9969
    2.1224    2.1722    2.2025
    1.4369    1.4656    1.4830
    0.9857    1.0003    1.0097
    0.9637    0.9757    0.9829


ans(:,:,4,1,1,2) =

  Columns 1 through 7

   -1.9871   -1.6757   -0.0001    2.1442    3.3537    3.9544    4.2616
   -2.8539   -2.5331   -0.8197    1.4103    2.5979    3.1823    3.4799
   -2.2572   -1.9524   -0.6203    1.2037    2.1090    2.5451    2.7645
   -2.8348   -2.2582   -0.8424    0.8506    1.5630    1.8850    2.0408
   -8.2527   -5.7362   -1.4115    0.4477    1.0539    1.2876    1.3872
   -6.0933   -3.5783   -0.4035    0.4845    0.7957    0.9076    0.9586
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.4296    4.5284    4.5887
    3.6430    3.7390    3.7981
    2.8842    2.9545    2.9979
    2.1244    2.1731    2.2029
    1.4369    1.4656    1.4830
    0.9857    1.0003    1.0097
    0.9637    0.9757    0.9829


ans(:,:,5,1,1,2) =

  Columns 1 through 7

    1.3384    1.4340    1.9251    2.8090    3.5724    4.0331    4.2928
    0.4668    0.5788    1.0908    2.0152    2.8021    3.2576    3.5099
    0.3244    0.3912    0.8586    1.6112    2.2492    2.5981    2.7859
   -0.7213   -0.6055    0.2050    1.0590    1.6392    1.9139    2.0523
   -8.2527   -5.7362   -1.4115    0.4477    1.0539    1.2876    1.3872
   -6.0933   -3.5783   -0.4035    0.4845    0.7957    0.9076    0.9586
   -5.9552   -3.4402   -0.2654    0.5677    0.8103    0.9015    0.9426

  Columns 8 through 10

    4.4432    4.5348    4.5918
    3.6558    3.7449    3.8010
    2.8931    2.9587    3.0000
    2.1287    2.1750    2.2038
    1.4369    1.4656    1.4830
    0.9857    1.0003    1.0097
    0.9637    0.9757    0.9829


ans(:,:,1,2,1,2) =

  Columns 1 through 7

  -25.8693  -18.8664   -4.6745    1.1138    3.0881    3.8725    4.2319
  -24.5479  -18.1850   -5.1225    0.4307    2.3418    3.1032    3.4520
  -16.2638  -12.2002   -3.4520    0.5334    1.9298    2.4892    2.7450
  -11.4128   -8.3660   -2.2970    0.4968    1.4679    1.8555    2.0315
   -6.7264   -4.8319   -1.2334    0.4774    1.0592    1.2889    1.3876
   -4.9811   -3.0867   -0.3372    0.4980    0.7977    0.9080    0.9588
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.4174    4.5228    4.5860
    3.6318    3.7339    3.7956
    2.8765    2.9511    2.9963
    2.1212    2.1717    2.2023
    1.4371    1.4657    1.4830
    0.9858    1.0003    1.0097
    0.9638    0.9757    0.9829


ans(:,:,2,2,1,2) =

  Columns 1 through 7

  -12.6464  -10.5212   -2.9826    1.4029    3.1521    3.8908    4.2382
  -12.6291  -10.6535   -3.4991    0.7143    2.4050    3.1212    3.4580
   -8.7691   -7.4929   -2.3268    0.7370    1.9757    2.5023    2.7493
   -7.2472   -5.8569   -1.6887    0.6051    1.4921    1.8623    2.0334
   -6.7264   -4.8319   -1.2334    0.4774    1.0592    1.2889    1.3876
   -4.9811   -3.0867   -0.3372    0.4980    0.7977    0.9080    0.9588
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.4199    4.5240    4.5866
    3.6342    3.7349    3.7961
    2.8782    2.9518    2.9966
    2.1219    2.1720    2.2024
    1.4371    1.4657    1.4830
    0.9858    1.0003    1.0097
    0.9638    0.9757    0.9829


ans(:,:,3,2,1,2) =

  Columns 1 through 7

   -4.9577   -4.3458   -1.1074    1.8395    3.2630    3.9247    4.2504
   -5.6552   -5.0367   -1.7479    1.1385    2.5144    3.1547    3.4697
   -4.2746   -3.7016   -1.1572    1.0370    2.0548    2.5267    2.7578
   -4.4320   -3.8118   -1.0522    0.7666    1.5343    1.8753    2.0374
   -6.7264   -4.8319   -1.2334    0.4774    1.0592    1.2889    1.3876
   -4.9811   -3.0867   -0.3372    0.4980    0.7977    0.9080    0.9588
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.4249    4.5262    4.5877
    3.6389    3.7370    3.7972
    2.8815    2.9533    2.9974
    2.1233    2.1726    2.2027
    1.4371    1.4657    1.4830
    0.9858    1.0003    1.0097
    0.9638    0.9757    0.9829


ans(:,:,4,2,1,2) =

  Columns 1 through 7

   -0.3752   -0.1831    0.8712    2.4113    3.4373    3.9835    4.2728
   -1.1477   -0.9620    0.0844    1.6733    2.6835    3.2125    3.4914
   -0.8046   -0.6346    0.1304    1.4033    2.1754    2.5687    2.7736
   -1.3774   -1.1835   -0.3721    0.9641    1.5992    1.8978    2.0455
   -6.7264   -4.8319   -1.2334    0.4774    1.0592    1.2889    1.3876
   -4.9811   -3.0867   -0.3372    0.4980    0.7977    0.9080    0.9588
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.4344    4.5306    4.5898
    3.6478    3.7412    3.7992
    2.8879    2.9562    2.9988
    2.1262    2.1739    2.2033
    1.4371    1.4657    1.4830
    0.9858    1.0003    1.0097
    0.9638    0.9757    0.9829


ans(:,:,5,2,1,2) =

  Columns 1 through 7

    2.1796    2.2353    2.5310    3.1091    3.6845    4.0768    4.3112
    1.3943    1.4535    1.7471    2.3248    2.9123    3.3018    3.5289
    1.1359    1.1736    1.4374    1.8673    2.3326    2.6321    2.8007
    0.1086    0.2152    0.7510    1.2067    1.6822    1.9320    2.0602
   -6.7264   -4.8319   -1.2334    0.4774    1.0592    1.2889    1.3876
   -4.9811   -3.0867   -0.3372    0.4980    0.7977    0.9080    0.9588
   -4.8695   -2.9750   -0.2255    0.5724    0.8112    0.9017    0.9427

  Columns 8 through 10

    4.4515    4.5388    4.5938
    3.6643    3.7490    3.8031
    2.8998    2.9618    3.0016
    2.1321    2.1764    2.2045
    1.4371    1.4657    1.4830
    0.9858    1.0003    1.0097
    0.9638    0.9757    0.9829


ans(:,:,1,1,2,2) =

  Columns 1 through 7

  -22.2465  -18.5513   -6.3727    0.0813    2.5516    3.5771    4.0558
  -21.4937  -17.9351   -6.4458   -0.3849    1.9180    2.8701    3.3119
  -15.4932  -13.0250   -4.5625   -0.0954    1.6083    2.3136    2.6395
  -11.8839   -9.7658   -3.2050    0.0463    1.2469    1.7374    1.9604
  -10.9352   -7.8138   -2.2368    0.1303    0.9131    1.2175    1.3477
   -7.7230   -4.6428   -0.7545    0.3524    0.7376    0.8780    0.9405
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3050    4.4471    4.5314
    3.5419    3.6732    3.7524
    2.8085    2.9051    2.9637
    2.0752    2.1407    2.1802
    1.4120    1.4491    1.4711
    0.9747    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,2,1,2,2) =

  Columns 1 through 7

  -15.0880  -13.2134   -4.9889    0.3632    2.6185    3.5970    4.0629
  -15.1240  -13.3785   -5.1960   -0.1284    1.9788    2.8880    3.3182
  -11.4127  -10.1585   -3.7370    0.0817    1.6509    2.3262    2.6438
   -9.4858   -8.4005   -2.7870    0.1373    1.2690    1.7439    1.9626
  -10.9352   -7.8138   -2.2368    0.1303    0.9131    1.2175    1.3477
   -7.7230   -4.6428   -0.7545    0.3524    0.7376    0.8780    0.9405
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3079    4.4484    4.5320
    3.5444    3.6743    3.7529
    2.8102    2.9059    2.9641
    2.0759    2.1410    2.1804
    1.4120    1.4491    1.4711
    0.9747    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,3,1,2,2) =

  Columns 1 through 7

   -8.1430   -7.3681   -3.2096    0.7997    2.7338    3.6329    4.0759
   -8.7390   -7.9078   -3.6315    0.2678    2.0834    2.9204    3.3299
   -7.0055   -6.2017   -2.7184    0.3535    1.7243    2.3491    2.6521
   -7.0256   -5.9887   -2.2754    0.2777    1.3071    1.7558    1.9669
  -10.9352   -7.8138   -2.2368    0.1303    0.9131    1.2175    1.3477
   -7.7230   -4.6428   -0.7545    0.3524    0.7376    0.8780    0.9405
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3132    4.4508    4.5332
    3.5491    3.6765    3.7539
    2.8134    2.9073    2.9648
    2.0775    2.1417    2.1807
    1.4120    1.4491    1.4711
    0.9747    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,4,1,2,2) =

  Columns 1 through 7

   -2.9298   -2.6171   -0.9519    1.4266    2.9228    3.6962    4.0998
   -3.5804   -3.2632   -1.6048    0.8188    2.2527    2.9774    3.3515
   -2.8923   -2.5979   -1.3034    0.7216    1.8415    2.3892    2.6674
   -3.1640   -2.8159   -1.5379    0.4675    1.3682    1.7767    1.9749
  -10.9352   -7.8138   -2.2368    0.1303    0.9131    1.2175    1.3477
   -7.7230   -4.6428   -0.7545    0.3524    0.7376    0.8780    0.9405
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3233    4.4554    4.5354
    3.5580    3.6805    3.7559
    2.8196    2.9101    2.9661
    2.0805    2.1430    2.1813
    1.4120    1.4491    1.4711
    0.9747    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,5,1,2,2) =

  Columns 1 through 7

    0.5895    0.6969    1.2422    2.2646    3.2064    3.8005    4.1419
   -0.1077    0.0003    0.5421    1.5617    2.5011    3.0704    3.3893
   -0.1492   -0.0781    0.4195    1.2351    2.0080    2.4532    2.6939
   -1.3472   -1.1865   -0.1199    0.7245    1.4538    1.8104    1.9888
  -10.9352   -7.8138   -2.2368    0.1303    0.9131    1.2175    1.3477
   -7.7230   -4.6428   -0.7545    0.3524    0.7376    0.8780    0.9405
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3418    4.4642    4.5396
    3.5746    3.6883    3.7597
    2.8312    2.9155    2.9688
    2.0865    2.1456    2.1825
    1.4120    1.4491    1.4711
    0.9747    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,1,2,2,2) =

  Columns 1 through 7

  -16.6974  -14.3625   -5.2976    0.2926    2.5999    3.5913    4.0607
  -16.1814  -14.0286   -5.4237   -0.1857    1.9632    2.8833    3.3164
  -11.5606  -10.1676   -3.7888    0.0593    1.6434    2.3239    2.6429
   -9.0839   -7.8766   -2.7184    0.1415    1.2679    1.7435    1.9624
   -8.9901   -6.6558   -2.0113    0.1679    0.9197    1.2194    1.3482
   -6.3564   -4.0362   -0.6688    0.3655    0.7402    0.8785    0.9408
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3070    4.4480    4.5318
    3.5437    3.6740    3.7528
    2.8099    2.9057    2.9640
    2.0759    2.1410    2.1804
    1.4122    1.4492    1.4711
    0.9748    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,2,2,2,2) =

  Columns 1 through 7

  -10.6779   -9.4960   -3.8703    0.6238    2.6837    3.6168    4.0699
  -10.8766   -9.7685   -4.1348    0.1191    2.0403    2.9067    3.3247
   -8.1949   -7.3005   -2.9397    0.2720    1.6985    2.3408    2.6489
   -7.3134   -6.4485   -2.2917    0.2498    1.2960    1.7522    1.9654
   -8.9901   -6.6558   -2.0113    0.1679    0.9197    1.2194    1.3482
   -6.3564   -4.0362   -0.6688    0.3655    0.7402    0.8785    0.9408
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3107    4.4497    4.5327
    3.5470    3.6755    3.7535
    2.8122    2.9068    2.9645
    2.0770    2.1415    2.1806
    1.4122    1.4492    1.4711
    0.9748    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,3,2,2,2) =

  Columns 1 through 7

   -5.1047   -4.6405   -2.0293    1.1150    2.8241    3.6623    4.0867
   -5.5342   -5.0757   -2.5257    0.5662    2.1691    2.9483    3.3402
   -4.1978   -3.7649   -1.8648    0.5798    1.7900    2.3708    2.6601
   -4.5531   -3.7381   -1.7737    0.4077    1.3431    1.7676    1.9711
   -8.9901   -6.6558   -2.0113    0.1679    0.9197    1.2194    1.3482
   -6.3564   -4.0362   -0.6688    0.3655    0.7402    0.8785    0.9408
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3177    4.4528    4.5342
    3.5533    3.6784    3.7549
    2.8166    2.9088    2.9655
    2.0791    2.1424    2.1810
    1.4122    1.4492    1.4711
    0.9748    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,4,2,2,2) =

  Columns 1 through 7

   -1.0798   -0.8874    0.1513    1.8028    3.0446    3.7399    4.1169
   -1.7019   -1.5054   -0.4793    1.1685    2.3672    3.0190    3.3679
   -1.2788   -1.1454   -0.3296    0.9879    1.9277    2.4212    2.6801
   -2.0218   -1.8736   -0.8379    0.6069    1.4145    1.7937    1.9815
   -8.9901   -6.6558   -2.0113    0.1679    0.9197    1.2194    1.3482
   -6.3564   -4.0362   -0.6688    0.3655    0.7402    0.8785    0.9408
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3306    4.4589    4.5371
    3.5650    3.6838    3.7575
    2.8250    2.9126    2.9674
    2.0832    2.1442    2.1819
    1.4122    1.4492    1.4711
    0.9748    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,5,2,2,2) =

  Columns 1 through 7

    1.6058    1.6654    1.9988    2.6656    3.3635    3.8625    4.1683
    0.9438    1.0008    1.3194    1.9636    2.6484    3.1285    3.4146
    0.7319    0.7778    1.0924    1.5779    2.1213    2.4972    2.7132
   -0.1588   -0.0474    0.4080    0.9416    1.5080    1.8332    1.9988
   -8.9901   -6.6558   -2.0113    0.1679    0.9197    1.2194    1.3482
   -6.3564   -4.0362   -0.6688    0.3655    0.7402    0.8785    0.9408
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3539    4.4700    4.5426
    3.5863    3.6939    3.7625
    2.8403    2.9199    2.9710
    2.0912    2.1478    2.1835
    1.4122    1.4492    1.4711
    0.9748    0.9929    1.0045
    0.9556    0.9702    0.9790


ans(:,:,1,1,1,3) =

  Columns 1 through 7

  -42.1857  -28.9551   -7.2460    0.3236    2.7583    3.7048    4.1353
  -39.4171  -27.3417   -7.4596   -0.2691    2.0539    2.9580    3.3689
  -27.7578  -19.4706   -5.4806   -0.0881    1.6725    2.3594    2.6707
  -19.2357  -13.2336   -3.7641    0.0418    1.2795    1.7612    1.9772
  -10.5488   -7.4621   -2.0981    0.1974    0.9431    1.2328    1.3551
   -7.6989   -4.6187   -0.7304    0.3598    0.7419    0.8795    0.9420
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3567    4.4822    4.5577
    3.5798    3.6990    3.7713
    2.8301    2.9200    2.9745
    2.0871    2.1488    2.1862
    1.4168    1.4519    1.4732
    0.9754    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,2,1,1,3) =

  Columns 1 through 7

  -21.7808  -17.4310   -5.3888    0.6067    2.8182    3.7216    4.1410
  -21.3002  -17.0659   -5.7179   -0.0006    2.1109    2.9739    3.3741
  -15.8760  -12.7325   -4.2313    0.1084    1.7145    2.3710    2.6744
  -12.8526   -9.7722   -3.0888    0.1470    1.3019    1.7672    1.9790
  -10.5488   -7.4621   -2.0981    0.1974    0.9431    1.2328    1.3551
   -7.6989   -4.6187   -0.7304    0.3598    0.7419    0.8795    0.9420
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3590    4.4832    4.5582
    3.5819    3.6999    3.7717
    2.8315    2.9207    2.9748
    2.0877    2.1491    2.1863
    1.4168    1.4519    1.4732
    0.9754    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,3,1,1,3) =

  Columns 1 through 7

  -10.3134   -9.1017   -3.1639    1.0596    2.9257    3.7533    4.1520
  -10.8860   -9.6670   -3.6573    0.4277    2.2134    3.0042    3.3843
   -8.7440   -7.7671   -2.7855    0.4200    1.7900    2.3934    2.6818
   -8.0368   -7.1212   -2.3022    0.3152    1.3425    1.7792    1.9824
  -10.5488   -7.4621   -2.0981    0.1974    0.9431    1.2328    1.3551
   -7.6989   -4.6187   -0.7304    0.3598    0.7419    0.8795    0.9420
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3634    4.4852    4.5592
    3.5859    3.7017    3.7726
    2.8344    2.9219    2.9755
    2.0889    2.1496    2.1865
    1.4168    1.4519    1.4732
    0.9754    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,4,1,1,3) =

  Columns 1 through 7

   -3.2158   -2.8490   -0.8490    1.6856    3.1029    3.8101    4.1728
   -3.9532   -3.5860   -1.5784    1.0120    2.3814    3.0584    3.4038
   -3.3244   -2.9565   -1.3452    0.8376    1.9130    2.4336    2.6960
   -3.9811   -3.2748   -1.5394    0.5421    1.4091    1.8009    1.9895
  -10.5488   -7.4621   -2.0981    0.1974    0.9431    1.2328    1.3551
   -7.6989   -4.6187   -0.7304    0.3598    0.7419    0.8795    0.9420
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3720    4.4891    4.5611
    3.5937    3.7053    3.7744
    2.8400    2.9245    2.9767
    2.0915    2.1507    2.1871
    1.4168    1.4519    1.4732
    0.9754    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,5,1,1,3) =

  Columns 1 through 7

    0.7019    0.8153    1.4044    2.4588    3.3617    3.9039    4.2101
   -0.1141    0.0168    0.6229    1.7062    2.6204    3.1469    3.4390
   -0.2354   -0.1544    0.4113    1.3230    2.0845    2.4986    2.7221
   -1.3903   -1.2476   -0.2492    0.7965    1.5024    1.8362    2.0036
  -10.5488   -7.4621   -2.0981    0.1974    0.9431    1.2328    1.3551
   -7.6989   -4.6187   -0.7304    0.3598    0.7419    0.8795    0.9420
   -7.5184   -4.4381   -0.5498    0.4706    0.7677    0.8793    0.9297

  Columns 8 through 10

    4.3881    4.4967    4.5648
    3.6085    3.7122    3.7778
    2.8507    2.9294    2.9791
    2.0967    2.1529    2.1881
    1.4168    1.4519    1.4732
    0.9754    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,1,2,1,3) =

  Columns 1 through 7

  -31.7394  -23.3211   -6.4335    0.4421    2.7823    3.7115    4.1376
  -29.4086  -21.9039   -6.6294   -0.1467    2.0788    2.9649    3.3712
  -20.2283  -15.2918   -4.7882    0.0155    1.6936    2.3652    2.6726
  -14.5054  -10.7573   -3.3212    0.1090    1.2931    1.7648    1.9784
   -8.6641   -6.3438   -1.8801    0.2334    0.9509    1.2345    1.3556
   -6.3361   -4.0159   -0.6485    0.3758    0.7445    0.8800    0.9423
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3576    4.4826    4.5579
    3.5807    3.6994    3.7715
    2.8309    2.9204    2.9747
    2.0875    2.1490    2.1863
    1.4170    1.4520    1.4733
    0.9755    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,2,2,1,3) =

  Columns 1 through 7

  -15.8418  -13.2581   -4.3896    0.7910    2.8595    3.7335    4.1451
  -15.3373  -12.9954   -4.7114    0.1878    2.1533    2.9861    3.3782
  -11.1129   -9.5499   -3.4105    0.2648    1.7497    2.3811    2.6777
   -9.3648   -7.6620   -2.5762    0.2416    1.3227    1.7730    1.9807
   -8.6641   -6.3438   -1.8801    0.2334    0.9509    1.2345    1.3556
   -6.3361   -4.0159   -0.6485    0.3758    0.7445    0.8800    0.9423
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3606    4.4839    4.5586
    3.5835    3.7007    3.7721
    2.8328    2.9212    2.9751
    2.0884    2.1494    2.1864
    1.4170    1.4520    1.4733
    0.9755    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,3,2,1,3) =

  Columns 1 through 7

   -6.7472   -6.0077   -2.1339    1.3181    2.9934    3.7743    4.1595
   -7.2327   -6.4953   -2.6438    0.6885    2.2824    3.0256    3.3918
   -5.7351   -5.0535   -1.9800    0.6322    1.8466    2.4111    2.6878
   -5.9219   -5.1668   -1.7967    0.4393    1.3744    1.7889    1.9855
   -8.6641   -6.3438   -1.8801    0.2334    0.9509    1.2345    1.3556
   -6.3361   -4.0159   -0.6485    0.3758    0.7445    0.8800    0.9423
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3664    4.4866    4.5599
    3.5889    3.7031    3.7733
    2.8368    2.9230    2.9760
    2.0901    2.1501    2.1868
    1.4170    1.4520    1.4733
    0.9755    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,4,2,1,3) =

  Columns 1 through 7

   -1.3153   -1.0901    0.1672    1.9984    3.2029    3.8450    4.1862
   -1.9707   -1.7597   -0.5387    1.3170    2.4821    3.0938    3.4173
   -1.5791   -1.3734   -0.4546    1.0790    1.9942    2.4625    2.7070
   -2.1949   -1.9575   -0.9603    0.6813    1.4540    1.8164    1.9952
   -8.6641   -6.3438   -1.8801    0.2334    0.9509    1.2345    1.3556
   -6.3361   -4.0159   -0.6485    0.3758    0.7445    0.8800    0.9423
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3776    4.4917    4.5624
    3.5993    3.7079    3.7757
    2.8445    2.9265    2.9777
    2.0936    2.1516    2.1875
    1.4170    1.4520    1.4733
    0.9755    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,5,2,1,3) =

  Columns 1 through 7

    1.7004    1.7662    2.1203    2.8095    3.4930    3.9559    4.2321
    0.9687    1.0402    1.3876    2.0622    2.7474    3.1986    3.4613
    0.7509    0.7956    1.1082    1.6254    2.1845    2.5401    2.7402
   -0.3682   -0.2369    0.4203    0.9761    1.5556    1.8584    2.0131
   -8.6641   -6.3438   -1.8801    0.2334    0.9509    1.2345    1.3556
   -6.3361   -4.0159   -0.6485    0.3758    0.7445    0.8800    0.9423
   -6.1886   -3.8684   -0.5010    0.4763    0.7688    0.8796    0.9298

  Columns 8 through 10

    4.3980    4.5014    4.5673
    3.6185    3.7169    3.7802
    2.8588    2.9332    2.9810
    2.1007    2.1547    2.1889
    1.4170    1.4520    1.4733
    0.9755    0.9933    1.0048
    0.9556    0.9702    0.9790


ans(:,:,1,1,2,3) =

  Columns 1 through 7

  -27.9239  -22.9769   -8.1889   -0.6092    2.2396    3.4136    3.9599
  -25.3482  -20.8312   -7.6258   -0.8281    1.7190    2.7664    3.2511
  -19.0648  -15.7165   -5.7116   -0.5313    1.4123    2.2120    2.5800
  -14.9386  -11.9459   -4.1246   -0.2966    1.0942    1.6592    1.9147
  -12.8666   -9.2607   -2.8143   -0.0820    0.8192    1.1711    1.3206
   -9.0760   -5.5193   -1.0294    0.2477    0.6924    0.8544    0.9266
   -8.8362   -5.2794   -0.7896    0.3887    0.7318    0.8607    0.9188

  Columns 8 through 10

    4.2444    4.4065    4.5029
    3.5033    3.6472    3.7343
    2.7710    2.8799    2.9460
    2.0464    2.1214    2.1666
    1.3949    1.4376    1.4629
    0.9660    0.9870    1.0004
    0.9487    0.9656    0.9758


ans(:,:,2,1,2,3) =

  Columns 1 through 7

  -18.8270  -16.4588   -6.5218   -0.2801    2.3166    3.4362    3.9679
  -17.6418  -15.5347   -6.1922   -0.5417    1.7861    2.7860    3.2578
  -13.8127  -12.2823   -4.7182   -0.3258    1.4611    2.2263    2.5849
  -11.5966  -10.2400   -3.6098   -0.1892    1.1198    1.6667    1.9172
  -12.8666   -9.2607   -2.8143   -0.0820    0.8192    1.1711    1.3206
   -9.0760   -5.5193   -1.0294    0.2477    0.6924    0.8544    0.9266
   -8.8362   -5.2794   -0.7896    0.3887    0.7318    0.8607    0.9188

  Columns 8 through 10

    4.2476    4.4079    4.5036
    3.5060    3.6484    3.7349
    2.7729    2.8808    2.9464
    2.0473    2.1217    2.1668
    1.3949    1.4376    1.4629
    0.9660    0.9870    1.0004
    0.9487    0.9656    0.9758


ans(:,:,3,1,2,3) =

  Columns 1 through 7

  -10.4228   -9.4735   -4.4206    0.2310    2.4496    3.4774    3.9827
  -10.3034   -9.3724   -4.4210   -0.0976    1.9022    2.8218    3.2706
   -8.6681   -7.7269   -3.5116   -0.0089    1.5455    2.2525    2.5942
   -8.7000   -7.5228   -2.9829   -0.0227    1.1641    1.6805    1.9220
  -12.8666   -9.2607   -2.8143   -0.0820    0.8192    1.1711    1.3206
   -9.0760   -5.5193   -1.0294    0.2477    0.6924    0.8544    0.9266
   -8.8362   -5.2794   -0.7896    0.3887    0.7318    0.8607    0.9188

  Columns 8 through 10

    4.2536    4.4106    4.5049
    3.5110    3.6507    3.7360
    2.7765    2.8824    2.9472
    2.0490    2.1225    2.1672
    1.3949    1.4376    1.4629
    0.9660    0.9870    1.0004
    0.9487    0.9656    0.9758


ans(:,:,4,1,2,3) =

  Columns 1 through 7

   -4.1679   -3.7989   -1.8253    0.9534    2.6671    3.5500    4.0101
   -4.4279   -4.0804   -2.2011    0.5122    2.0893    2.8844    3.2943
   -3.7719   -3.4363   -1.9217    0.4177    1.6806    2.2984    2.6117
   -4.1023   -3.6605   -2.1408    0.2022    1.2357    1.7048    1.9312
  -12.8666   -9.2607   -2.8143   -0.0820    0.8192    1.1711    1.3206
   -9.0760   -5.5193   -1.0294    0.2477    0.6924    0.8544    0.9266
   -8.8362   -5.2794   -0.7896    0.3887    0.7318    0.8607    0.9188

  Columns 8 through 10

    4.2651    4.4159    4.5075
    3.5207    3.6551    3.7382
    2.7835    2.8856    2.9487
    2.0524    2.1239    2.1678
    1.3949    1.4376    1.4629
    0.9660    0.9870    1.0004
    0.9487    0.9656    0.9758


ans(:,:,5,1,2,3) =

  Columns 1 through 7

   -0.0458    0.0799    0.7177    1.9067    2.9912    3.6696    4.0584
   -0.5560   -0.4277    0.1818    1.3208    2.3609    2.9865    3.3359
   -0.6010   -0.5198    0.0487    0.9911    1.8708    2.3719    2.6420
   -1.9274   -1.7442   -0.5069    0.4960    1.3358    1.7440    1.9473
  -12.8666   -9.2607   -2.8143   -0.0820    0.8192    1.1711    1.3206
   -9.0760   -5.5193   -1.0294    0.2477    0.6924    0.8544    0.9266
   -8.8362   -5.2794   -0.7896    0.3887    0.7318    0.8607    0.9188

  Columns 8 through 10

    4.2862    4.4258    4.5123
    3.5389    3.6636    3.7423
    2.7967    2.8916    2.9517
    2.0592    2.1269    2.1692
    1.3949    1.4376    1.4629
    0.9660    0.9870    1.0004
    0.9487    0.9656    0.9758


ans(:,:,1,2,2,3) =

  Columns 1 through 7

  -21.1387  -18.0503   -6.9682   -0.3765    2.2923    3.4289    3.9651
  -19.1169  -16.4226   -6.5101   -0.6158    1.7667    2.7802    3.2557
  -14.2442  -12.3593   -4.8328   -0.3612    1.4506    2.2230    2.5837
  -11.3745   -9.6864   -3.5637   -0.1903    1.1174    1.6659    1.9168
  -10.6200   -7.9237   -2.5550   -0.0388    0.8275    1.1732    1.3211
   -7.4982   -4.8191   -0.9307    0.2629    0.6954    0.8550    0.9269
   -7.3007   -4.6215   -0.7332    0.3953    0.7331    0.8610    0.9189

  Columns 8 through 10

    4.2465    4.4074    4.5034
    3.5052    3.6480    3.7347
    2.7725    2.8806    2.9463
    2.0473    2.1217    2.1668
    1.3951    1.4377    1.4629
    0.9661    0.9870    1.0004
    0.9488    0.9656    0.9758


ans(:,:,2,2,2,3) =

  Columns 1 through 7

  -13.6542  -12.1524   -5.2396    0.0122    2.3889    3.4581    3.9755
  -12.9180  -11.5519   -5.0243   -0.2742    1.8521    2.8059    3.2648
  -10.0957   -9.0628   -3.8037   -0.1126    1.5139    2.2422    2.5904
   -9.0161   -8.0343   -3.0334   -0.0616    1.1502    1.6758    1.9202
  -10.6200   -7.9237   -2.5550   -0.0388    0.8275    1.1732    1.3211
   -7.4982   -4.8191   -0.9307    0.2629    0.6954    0.8550    0.9269
   -7.3007   -4.6215   -0.7332    0.3953    0.7331    0.8610    0.9189

  Columns 8 through 10

    4.2507    4.4093    4.5043
    3.5087    3.6496    3.7355
    2.7751    2.8818    2.9469
    2.0485    2.1222    2.1671
    1.3951    1.4377    1.4629
    0.9661    0.9870    1.0004
    0.9488    0.9656    0.9758


ans(:,:,3,2,2,3) =

  Columns 1 through 7

   -6.8305   -6.2623   -3.0946    0.5885    2.5512    3.5103    3.9948
   -6.6980   -6.1738   -3.2275    0.2284    1.9952    2.8519    3.2817
   -5.4009   -4.8785   -2.5675    0.2481    1.6195    2.2766    2.6031
   -5.9063   -4.9300   -2.4142    0.1268    1.2054    1.6937    1.9267
  -10.6200   -7.9237   -2.5550   -0.0388    0.8275    1.1732    1.3211
   -7.4982   -4.8191   -0.9307    0.2629    0.6954    0.8550    0.9269
   -7.3007   -4.6215   -0.7332    0.3953    0.7331    0.8610    0.9189

  Columns 8 through 10

    4.2586    4.4129    4.5060
    3.5155    3.6527    3.7370
    2.7801    2.8840    2.9480
    2.0508    2.1232    2.1675
    1.3951    1.4377    1.4629
    0.9661    0.9870    1.0004
    0.9488    0.9656    0.9758


ans(:,:,4,2,2,3) =

  Columns 1 through 7

   -2.0273   -1.7998   -0.5653    1.3757    2.8052    3.5995    4.0295
   -2.3447   -2.1316   -0.9650    0.8897    2.2140    2.9297    3.3122
   -1.9267   -1.7626   -0.8271    0.7128    1.7787    2.3345    2.6260
   -2.7068   -2.5325   -1.3516    0.3621    1.2891    1.7241    1.9387
  -10.6200   -7.9237   -2.5550   -0.0388    0.8275    1.1732    1.3211
   -7.4982   -4.8191   -0.9307    0.2629    0.6954    0.8550    0.9269
   -7.3007   -4.6215   -0.7332    0.3953    0.7331    0.8610    0.9189

  Columns 8 through 10

    4.2733    4.4197    4.5094
    3.5283    3.6586    3.7399
    2.7896    2.8883    2.9501
    2.0555    2.1253    2.1685
    1.3951    1.4377    1.4629
    0.9661    0.9870    1.0004
    0.9488    0.9656    0.9758


ans(:,:,5,2,2,3) =

  Columns 1 through 7

    1.1254    1.1962    1.5849    2.3612    3.1680    3.7398    4.0884
    0.6162    0.6844    1.0407    1.7597    2.5203    3.0497    3.3634
    0.4102    0.4612    0.8161    1.3733    1.9963    2.4215    2.6640
   -0.5704   -0.4321    0.1244    0.7401    1.3979    1.7701    1.9588
  -10.6200   -7.9237   -2.5550   -0.0388    0.8275    1.1732    1.3211
   -7.4982   -4.8191   -0.9307    0.2629    0.6954    0.8550    0.9269
   -7.3007   -4.6215   -0.7332    0.3953    0.7331    0.8610    0.9189

  Columns 8 through 10

    4.3000    4.4324    4.5157
    3.5516    3.6697    3.7454
    2.8070    2.8966    2.9542
    2.0646    2.1293    2.1703
    1.3951    1.4377    1.4629
    0.9661    0.9870    1.0004
    0.9488    0.9656    0.9758

</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2019b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% SNW_VFI_MAIN Solves Policy/Value Function SNW (Loop)
%    Given parameters, iterate over life cycle, given age, marital status,
%    education level and child count, as well as persistent productivity
%    shock process, solve for optimal dynamic savings choices given
%    expectation of kid count transition and productivity shock transition.
%
%    Pref, Technology, and prices SCALARS:
%
%    * BETA discount
%    * THETA total factor productivity normalizer
%    * R interest rate
%
%    Vectorized State Space ARRAYS:
%
%    * AGRID asset grid
%    * ETA_GRID productivity shock grid
%
%    Transition Matrixes ARRAYS:
%
%    * PI_ETA shock productivity transition
%    * PI_KIDS shock kids count transition
%    * PSI shock survival probability
%
%    Permanent Education Type Heterogeneity ARRAYS:
%
%    * EPSILON perfect-foresight education type transition
%    * SS Social Security
%
%    [V_VFI,AP_VFI,CONS_VFI,EXITFLAG_VFI] = SNW_VFI_MAIN(MP_PARAMS) invoke
%    model with externally set parameter map MP_PARAMS.
%
%    [V_VFI,AP_VFI,CONS_VFI,EXITFLAG_VFI] = SNW_VFI_MAIN(MP_PARAMS,
%    MP_CONTROLS) invoke model with externally set parameter map MP_PARAMS
%    as well as control mpa MP_CONTROLS.
%
%    See also SNWX_VFI_MAIN, SNW_MP_CONTROL, SNW_MP_PARAM
%

%%
function [V_VFI,ap_VFI,cons_VFI,exitflag_VFI]=snw_vfi_main(varargin)

%% Default and Parse 
if (~isempty(varargin))
    
    if (length(varargin)==1)
        [mp_params] = varargin{:};
        mp_controls = snw_mp_control('default_base');
    elseif (length(varargin)==2)
        [mp_params, mp_controls] = varargin{:};
    end
    
else
    
    mp_params = snw_mp_param('default_tiny');
    mp_controls = snw_mp_control('default_test');
    
end

%% Reset All globals
% globals = who('global');
% clear(globals{:});
% Parameters used in this code directly
global beta theta r agrid epsilon eta_grid SS pi_eta pi_kids psi n_jgrid n_agrid n_etagrid n_educgrid n_marriedgrid n_kidsgrid
% Used in functions that are called by this code
global gamma g_n g_cons a2 cons_allocation_rule

%% Parse Model Parameters
params_group = values(mp_params, {'gamma', 'beta', 'theta', 'cons_allocation_rule', ...
    'r', 'g_n', 'g_cons', 'a2'});
[gamma, beta, theta, cons_allocation_rule, ...
    r, g_n, g_cons, a2] = params_group{:};

params_group = values(mp_params, {'agrid', 'eta_grid'});
[agrid, eta_grid] = params_group{:};

params_group = values(mp_params, {'pi_eta', 'pi_kids', 'psi'});
[pi_eta, pi_kids, psi] = params_group{:};

params_group = values(mp_params, {'epsilon', 'SS'});
[epsilon, SS] = params_group{:};

params_group = values(mp_params, ...
    {'n_jgrid', 'n_agrid', 'n_etagrid', 'n_educgrid', 'n_marriedgrid', 'n_kidsgrid'});
[n_jgrid, n_agrid, n_etagrid, n_educgrid, n_marriedgrid, n_kidsgrid] = params_group{:};

%% Parse Model Controls
% Minimizer Controls
params_group = values(mp_controls, ...
    {'A_aux', 'B_aux', ...
     'Aeq', 'Beq',...
     'nonlcon', 'options', 'options2'});
[A_aux, B_aux, ...
    Aeq, Beq, ...
    nonlcon, options, options2] = params_group{:};

% Profiling Controls
params_group = values(mp_controls, {'bl_timer'});
[bl_timer] = params_group{:};

% Display Controls
params_group = values(mp_controls, {'bl_print_vfi', 'bl_print_vfi_verbose'});
[bl_print_vfi, bl_print_vfi_verbose] = params_group{:};

%% Timing and Profiling Start
if (bl_timer)
    tic
end

%% Solve optimization problem

V_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
ap_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);
cons_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);

exitflag_VFI=NaN(n_jgrid,n_agrid,n_etagrid,n_educgrid,n_marriedgrid,n_kidsgrid);

% Solve for value function and policy functions by means of backwards induction
for j=n_jgrid:(-1):1 % Age
    for a=1:n_agrid % Assets
        for eta=1:n_etagrid % Productivity
            for educ=1:n_educgrid % Educational level
                for married=1:n_marriedgrid % Marital status
                    for kids=1:n_kidsgrid % Number of kids
                        
                        if j==n_jgrid
                            
                            ap_VFI(j,a,eta,educ,married,kids)=0;
                            cons_VFI(j,a,eta,educ,married,kids) = consumption(j,a,eta,educ,married,kids,ap_VFI(j,a,eta,educ,married,kids));
                            
                            if cons_VFI(j,a,eta,educ,married,kids)<=0
                                disp([j,a,eta,educ,married,kids,cons_VFI(j,a,eta,educ,married,kids)])
                                error('Non-positive consumption')
                            end
                            
                            V_VFI(j,a,eta,educ,married,kids)=utility(cons_VFI(j,a,eta,educ,married,kids),married,kids);
                            
                        else
                            
                            % Solve for next period's assets
                            x0=agrid(a); % Initial guess for ap
                            
                            amin=0;
                            [inc,earn]=individual_income(j,a,eta,educ);
                            spouse_inc=spousal_income(j,educ,kids,earn,SS(j,educ));
                            
                            amax = min(agrid(end), ...
                                (1+r)*agrid(a) ...
                                + epsilon(j,educ)*theta*exp(eta_grid(eta)) ...
                                + SS(j,educ) ...
                                + (married-1)*spouse_inc ...
                                - max(0,Tax(inc,(married-1)*spouse_inc)));
                            
                            [ap_aux,~,exitflag_VFI(j,a,eta,educ,married,kids)]=...
                                fmincon(@(x)value_func_aux(x,j,a,eta,educ,married,kids,V_VFI), ...
                                x0,A_aux,B_aux,Aeq,Beq,amin,amax,nonlcon,options);
                            
                            ind_aux=find(agrid<=ap_aux,1,'last');
                            
                            % Linear interpolation
                            if ap_aux==0
                                inds(1)=1;
                                inds(2)=1;
                                vals(1)=1;
                                vals(2)=0;
                                
                            elseif ap_aux==agrid(n_agrid)
                                inds(1)=n_agrid;
                                inds(2)=n_agrid;
                                vals(1)=1;
                                vals(2)=0;
                                
                            else
                                inds(1)=ind_aux;
                                inds(2)=ind_aux+1;
                                vals(1)=1-((ap_aux-agrid(inds(1)))/(agrid(inds(2))-agrid(inds(1))));
                                vals(2)=1-vals(1);
                                
                            end
                            
                            cont=0;
                            for etap=1:n_etagrid
                                for kidsp=1:n_kidsgrid
                                    cont=cont ...
                                        +pi_eta(eta,etap)*pi_kids(kids,kidsp,j,married)*(...
                                            vals(1)*V_VFI(j+1,inds(1),etap,educ,married,kidsp) ...
                                            +vals(2)*V_VFI(j+1,inds(2),etap,educ,married,kidsp));
                                end
                            end
                            
                            c_aux=consumption(j,a,eta,educ,married,kids,ap_aux);
                            
                            ap_VFI(j,a,eta,educ,married,kids)=ap_aux;
                            cons_VFI(j,a,eta,educ,married,kids)=c_aux;
                            
                            V_VFI(j,a,eta,educ,married,kids)=utility(c_aux,married,kids)+beta*psi(j)*cont;
                            
                            c_aux3=consumption(j,a,eta,educ,married,kids,0);
                            
                            cont=0;
                            for etap=1:n_etagrid
                                for kidsp=1:n_kidsgrid
                                    cont=cont+pi_eta(eta,etap)*pi_kids(kids,kidsp,j,married)*V_VFI(j+1,1,etap,educ,married,kidsp);
                                end
                            end
                            V_aux3=utility(c_aux3,married,kids)+beta*psi(j)*cont;
                            
                            if V_aux3>V_VFI(j,a,eta,educ,married,kids)
                                ap_VFI(j,a,eta,educ,married,kids)=0;
                                cons_VFI(j,a,eta,educ,married,kids)=c_aux3;
                                
                                V_VFI(j,a,eta,educ,married,kids)=V_aux3;
                            end
                            
                            if cons_VFI(j,a,eta,educ,married,kids)<=0
                                disp([j,a,eta,educ,married,kids,cons_VFI(j,a,eta,educ,married,kids)])
                                error('Non-positive consumption')
                            end
                            
                        end
                        
                    end
                end
            end
        end
    end
    
    if (bl_print_vfi)
        disp(strcat(['SNW_VFI_MAIN: Finished Age Group:' num2str(j) ' of ' num2str(n_jgrid)]));
    end
    
end

%% Timing and Profiling End
if (bl_timer)
    toc;    
    st_complete_vfi = strjoin(...
        ["Completed SNW_VFI_MAIN", ...
         ['SNW_MP_PARAM=' mp_params('mp_params_name')], ...
         ['SNW_MP_CONTROL=' mp_controls('mp_params_name')] ...
        ], ";");
    disp(st_complete_vfi);
end

end

##### SOURCE END #####
--></body></html>